/*

 Underscore.js 1.1.4
 (c) 2011 Jeremy Ashkenas, DocumentCloud Inc.
 Underscore is freely distributable under the MIT license.
 Portions of Underscore are inspired or borrowed from Prototype,
 Oliver Steele's Functional, and John Resig's Micro-Templating.
 For all details and documentation:
 http://documentcloud.github.com/underscore
*/
(function(){var n=this,Q=n._,S={},J=Array.prototype,V=Object.prototype,p=J.slice,E=J.unshift,M=V.toString,w=V.hasOwnProperty,G=J.forEach,h=J.map,m=J.reduce,v=J.reduceRight,g=J.filter,k=J.every,D=J.some,H=J.indexOf,W=J.lastIndexOf;V=Array.isArray;var T=Object.keys,z=function(j){return new x(j)};if(typeof module!=="undefined"&&module.exports){module.exports=z;z._=z}else n._=z;z.VERSION="1.1.4";var ea=z.each=z.forEach=function(j,q,y){if(j!=null)if(G&&j.forEach===G)j.forEach(q,y);else if(z.isNumber(j.length))for(var C=
0,N=j.length;C<N;C++){if(q.call(y,j[C],C,j)===S)break}else for(C in j)if(w.call(j,C))if(q.call(y,j[C],C,j)===S)break};z.map=function(j,q,y){var C=[];if(j==null)return C;if(h&&j.map===h)return j.map(q,y);ea(j,function(N,P,Z){C[C.length]=q.call(y,N,P,Z)});return C};z.reduce=z.foldl=z.inject=function(j,q,y,C){var N=y!==void 0;if(j==null)j=[];if(m&&j.reduce===m){if(C)q=z.bind(q,C);return N?j.reduce(q,y):j.reduce(q)}ea(j,function(P,Z,ka){if(!N&&Z===0){y=P;N=true}else y=q.call(C,y,P,Z,ka)});if(!N)throw new TypeError("Reduce of empty array with no initial value");
return y};z.reduceRight=z.foldr=function(j,q,y,C){if(j==null)j=[];if(v&&j.reduceRight===v){if(C)q=z.bind(q,C);return y!==void 0?j.reduceRight(q,y):j.reduceRight(q)}j=(z.isArray(j)?j.slice():z.toArray(j)).reverse();return z.reduce(j,q,y,C)};z.find=z.detect=function(j,q,y){var C;ha(j,function(N,P,Z){if(q.call(y,N,P,Z)){C=N;return true}});return C};z.filter=z.select=function(j,q,y){var C=[];if(j==null)return C;if(g&&j.filter===g)return j.filter(q,y);ea(j,function(N,P,Z){if(q.call(y,N,P,Z))C[C.length]=
N});return C};z.reject=function(j,q,y){var C=[];if(j==null)return C;ea(j,function(N,P,Z){q.call(y,N,P,Z)||(C[C.length]=N)});return C};z.every=z.all=function(j,q,y){q=q||z.identity;var C=true;if(j==null)return C;if(k&&j.every===k)return j.every(q,y);ea(j,function(N,P,Z){if(!(C=C&&q.call(y,N,P,Z)))return S});return C};var ha=z.some=z.any=function(j,q,y){q=q||z.identity;var C=false;if(j==null)return C;if(D&&j.some===D)return j.some(q,y);ea(j,function(N,P,Z){if(C=q.call(y,N,P,Z))return S});return C};
z.include=z.contains=function(j,q){var y=false;if(j==null)return y;if(H&&j.indexOf===H)return j.indexOf(q)!=-1;ha(j,function(C){if(y=C===q)return true});return y};z.invoke=function(j,q){var y=p.call(arguments,2);return z.map(j,function(C){return(q?C[q]:C).apply(C,y)})};z.pluck=function(j,q){return z.map(j,function(y){return y[q]})};z.max=function(j,q,y){if(!q&&z.isArray(j))return Math.max.apply(Math,j);var C={computed:-Infinity};ea(j,function(N,P,Z){P=q?q.call(y,N,P,Z):N;P>=C.computed&&(C={value:N,
computed:P})});return C.value};z.min=function(j,q,y){if(!q&&z.isArray(j))return Math.min.apply(Math,j);var C={computed:Infinity};ea(j,function(N,P,Z){P=q?q.call(y,N,P,Z):N;P<C.computed&&(C={value:N,computed:P})});return C.value};z.sortBy=function(j,q,y){return z.pluck(z.map(j,function(C,N,P){return{value:C,criteria:q.call(y,C,N,P)}}).sort(function(C,N){var P=C.criteria,Z=N.criteria;return P<Z?-1:P>Z?1:0}),"value")};z.sortedIndex=function(j,q,y){y=y||z.identity;for(var C=0,N=j.length;C<N;){var P=C+
N>>1;y(j[P])<y(q)?C=P+1:N=P}return C};z.toArray=function(j){if(!j)return[];if(j.toArray)return j.toArray();if(z.isArray(j))return j;if(z.isArguments(j))return p.call(j);return z.values(j)};z.size=function(j){return z.toArray(j).length};z.first=z.head=function(j,q,y){return q&&!y?p.call(j,0,q):j[0]};z.rest=z.tail=function(j,q,y){return p.call(j,z.isUndefined(q)||y?1:q)};z.last=function(j){return j[j.length-1]};z.compact=function(j){return z.filter(j,function(q){return!!q})};z.flatten=function(j){return z.reduce(j,
function(q,y){if(z.isArray(y))return q.concat(z.flatten(y));q[q.length]=y;return q},[])};z.without=function(j){var q=p.call(arguments,1);return z.filter(j,function(y){return!z.include(q,y)})};z.uniq=z.unique=function(j,q){return z.reduce(j,function(y,C,N){if(0==N||(q===true?z.last(y)!=C:!z.include(y,C)))y[y.length]=C;return y},[])};z.intersect=function(j){var q=p.call(arguments,1);return z.filter(z.uniq(j),function(y){return z.every(q,function(C){return z.indexOf(C,y)>=0})})};z.zip=function(){for(var j=
p.call(arguments),q=z.max(z.pluck(j,"length")),y=Array(q),C=0;C<q;C++)y[C]=z.pluck(j,""+C);return y};z.indexOf=function(j,q,y){if(j==null)return-1;if(y){y=z.sortedIndex(j,q);return j[y]===q?y:-1}if(H&&j.indexOf===H)return j.indexOf(q);y=0;for(var C=j.length;y<C;y++)if(j[y]===q)return y;return-1};z.lastIndexOf=function(j,q){if(j==null)return-1;if(W&&j.lastIndexOf===W)return j.lastIndexOf(q);for(var y=j.length;y--;)if(j[y]===q)return y;return-1};z.range=function(j,q,y){var C=p.call(arguments),N=C.length<=
1;j=N?0:C[0];q=N?C[0]:C[1];y=C[2]||1;C=Math.max(Math.ceil((q-j)/y),0);N=0;for(var P=Array(C);N<C;){P[N++]=j;j+=y}return P};z.bind=function(j,q){var y=p.call(arguments,2);return function(){return j.apply(q||{},y.concat(p.call(arguments)))}};z.bindAll=function(j){var q=p.call(arguments,1);if(q.length==0)q=z.functions(j);ea(q,function(y){j[y]=z.bind(j[y],j)});return j};z.memoize=function(j,q){var y={};q=q||z.identity;return function(){var C=q.apply(this,arguments);return C in y?y[C]:y[C]=j.apply(this,
arguments)}};z.delay=function(j,q){var y=p.call(arguments,2);return setTimeout(function(){return j.apply(j,y)},q)};z.defer=function(j){return z.delay.apply(z,[j,1].concat(p.call(arguments,1)))};var A=function(j,q,y){var C;return function(){var N=this,P=arguments,Z=function(){C=null;j.apply(N,P)};y&&clearTimeout(C);if(y||!C)C=setTimeout(Z,q)}};z.throttle=function(j,q){return A(j,q,false)};z.debounce=function(j,q){return A(j,q,true)};z.wrap=function(j,q){return function(){var y=[j].concat(p.call(arguments));
return q.apply(this,y)}};z.compose=function(){var j=p.call(arguments);return function(){for(var q=p.call(arguments),y=j.length-1;y>=0;y--)q=[j[y].apply(this,q)];return q[0]}};z.keys=T||function(j){if(z.isArray(j))return z.range(0,j.length);var q=[],y;for(y in j)if(w.call(j,y))q[q.length]=y;return q};z.values=function(j){return z.map(j,z.identity)};z.functions=z.methods=function(j){return z.filter(z.keys(j),function(q){return z.isFunction(j[q])}).sort()};z.extend=function(j){ea(p.call(arguments,1),
function(q){for(var y in q)j[y]=q[y]});return j};z.clone=function(j){return z.isArray(j)?j.slice():z.extend({},j)};z.tap=function(j,q){q(j);return j};z.isEqual=function(j,q){if(j===q)return true;var y=typeof j;if(y!=typeof q)return false;if(j==q)return true;if(!j&&q||j&&!q)return false;if(j._chain)j=j._wrapped;if(q._chain)q=q._wrapped;if(j.isEqual)return j.isEqual(q);if(z.isDate(j)&&z.isDate(q))return j.getTime()===q.getTime();if(z.isNaN(j)&&z.isNaN(q))return false;if(z.isRegExp(j)&&z.isRegExp(q))return j.source===
q.source&&j.global===q.global&&j.ignoreCase===q.ignoreCase&&j.multiline===q.multiline;if(y!=="object")return false;if(j.length&&j.length!==q.length)return false;y=z.keys(j);var C=z.keys(q);if(y.length!=C.length)return false;for(var N in j)if(!(N in q)||!z.isEqual(j[N],q[N]))return false;return true};z.isEmpty=function(j){if(z.isArray(j)||z.isString(j))return j.length===0;for(var q in j)if(w.call(j,q))return false;return true};z.isElement=function(j){return!!(j&&j.nodeType==1)};z.isArray=V||function(j){return M.call(j)===
"[object Array]"};z.isArguments=function(j){return!!(j&&w.call(j,"callee"))};z.isFunction=function(j){return!!(j&&j.constructor&&j.call&&j.apply)};z.isString=function(j){return!!(j===""||j&&j.charCodeAt&&j.substr)};z.isNumber=function(j){return!!(j===0||j&&j.toExponential&&j.toFixed)};z.isNaN=function(j){return j!==j};z.isBoolean=function(j){return j===true||j===false};z.isDate=function(j){return!!(j&&j.getTimezoneOffset&&j.setUTCFullYear)};z.isRegExp=function(j){return!!(j&&j.test&&j.exec&&(j.ignoreCase||
j.ignoreCase===false))};z.isNull=function(j){return j===null};z.isUndefined=function(j){return j===void 0};z.noConflict=function(){n._=Q;return this};z.identity=function(j){return j};z.times=function(j,q,y){for(var C=0;C<j;C++)q.call(y,C)};z.mixin=function(j){ea(z.functions(j),function(q){F(q,z[q]=j[q])})};var o=0;z.uniqueId=function(j){var q=o++;return j?j+q:q};z.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};z.template=function(j,q){var y=z.templateSettings;y="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+
j.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(y.interpolate,function(C,N){return"',"+N.replace(/\\'/g,"'")+",'"}).replace(y.evaluate||null,function(C,N){return"');"+N.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";y=new Function("obj",y);return q?y(q):y};var x=function(j){this._wrapped=j};z.prototype=x.prototype;var B=function(j,q){return q?z(j).chain():j},F=function(j,q){x.prototype[j]=function(){var y=
p.call(arguments);E.call(y,this._wrapped);return B(q.apply(z,y),this._chain)}};z.mixin(z);ea(["pop","push","reverse","shift","sort","splice","unshift"],function(j){var q=J[j];x.prototype[j]=function(){q.apply(this._wrapped,arguments);return B(this._wrapped,this._chain)}});ea(["concat","join","slice"],function(j){var q=J[j];x.prototype[j]=function(){return B(q.apply(this._wrapped,arguments),this._chain)}});x.prototype.chain=function(){this._chain=true;return this};x.prototype.value=function(){return this._wrapped}})();/*

 Backbone.js 0.3.3
 (c) 2010 Jeremy Ashkenas, DocumentCloud Inc.
 Backbone may be freely distributed under the MIT license.
 For all details and documentation:
 http://documentcloud.github.com/backbone
*/
(function(){var n;n=typeof exports!=="undefined"?exports:this.Backbone={};n.VERSION="0.3.3";var Q=this._;if(!Q&&typeof require!=="undefined")Q=require("underscore")._;var S=this.jQuery||this.Zepto;n.emulateHTTP=false;n.emulateJSON=false;n.Events={bind:function(g,k){this._callbacks||(this._callbacks={});(this._callbacks[g]||(this._callbacks[g]=[])).push(k);return this},unbind:function(g,k){var D;if(g){if(D=this._callbacks)if(k){D=D[g];if(!D)return this;for(var H=0,W=D.length;H<W;H++)if(k===D[H]){D.splice(H,
1);break}}else D[g]=[]}else this._callbacks={};return this},trigger:function(g){var k,D,H,W;if(!(D=this._callbacks))return this;if(k=D[g]){H=0;for(W=k.length;H<W;H++)k[H].apply(this,Array.prototype.slice.call(arguments,1))}if(k=D.all){H=0;for(W=k.length;H<W;H++)k[H].apply(this,arguments)}return this}};n.Model=function(g,k){g||(g={});if(this.defaults)g=Q.extend({},this.defaults,g);this.attributes={};this._escapedAttributes={};this.cid=Q.uniqueId("c");this.set(g,{silent:true});this._previousAttributes=
Q.clone(this.attributes);if(k&&k.collection)this.collection=k.collection;this.initialize(g,k)};Q.extend(n.Model.prototype,n.Events,{_previousAttributes:null,_changed:false,initialize:function(){},toJSON:function(){return Q.clone(this.attributes)},get:function(g){return this.attributes[g]},escape:function(g){var k;if(k=this._escapedAttributes[g])return k;k=this.attributes[g];return this._escapedAttributes[g]=(k==null?"":k).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,
"&quot;")},set:function(g,k){k||(k={});if(!g)return this;if(g.attributes)g=g.attributes;var D=this.attributes,H=this._escapedAttributes;if(!k.silent&&this.validate&&!this._performValidation(g,k))return false;if("id"in g)this.id=g.id;for(var W in g){var T=g[W];if(!Q.isEqual(D[W],T)){D[W]=T;delete H[W];if(!k.silent){this._changed=true;this.trigger("change:"+W,this,T,k)}}}!k.silent&&this._changed&&this.change(k);return this},unset:function(g,k){k||(k={});var D={};D[g]=void 0;if(!k.silent&&this.validate&&
!this._performValidation(D,k))return false;delete this.attributes[g];delete this._escapedAttributes[g];if(!k.silent){this._changed=true;this.trigger("change:"+g,this,void 0,k);this.change(k)}return this},clear:function(g){g||(g={});var k=this.attributes,D={};for(attr in k)D[attr]=void 0;if(!g.silent&&this.validate&&!this._performValidation(D,g))return false;this.attributes={};this._escapedAttributes={};if(!g.silent){this._changed=true;for(attr in k)this.trigger("change:"+attr,this,void 0,g);this.change(g)}return this},
fetch:function(g){g||(g={});var k=this,D=v(g.error,k,g);(this.sync||n.sync)("read",this,function(H){if(!k.set(k.parse(H),g))return false;g.success&&g.success(k,H)},D);return this},save:function(g,k){k||(k={});if(g&&!this.set(g,k))return false;var D=this,H=v(k.error,D,k),W=this.isNew()?"create":"update";(this.sync||n.sync)(W,this,function(T){if(!D.set(D.parse(T),k))return false;k.success&&k.success(D,T)},H);return this},destroy:function(g){g||(g={});var k=this,D=v(g.error,k,g);(this.sync||n.sync)("delete",
this,function(H){k.collection&&k.collection.remove(k);g.success&&g.success(k,H)},D);return this},url:function(){var g=m(this.collection);if(this.isNew())return g;return g+(g.charAt(g.length-1)=="/"?"":"/")+this.id},parse:function(g){return g},clone:function(){return new this.constructor(this)},isNew:function(){return!this.id},change:function(g){this.trigger("change",this,g);this._previousAttributes=Q.clone(this.attributes);this._changed=false},hasChanged:function(g){if(g)return this._previousAttributes[g]!=
this.attributes[g];return this._changed},changedAttributes:function(g){g||(g=this.attributes);var k=this._previousAttributes,D=false,H;for(H in g)if(!Q.isEqual(k[H],g[H])){D=D||{};D[H]=g[H]}return D},previous:function(g){if(!g||!this._previousAttributes)return null;return this._previousAttributes[g]},previousAttributes:function(){return Q.clone(this._previousAttributes)},_performValidation:function(g,k){var D=this.validate(g);if(D){k.error?k.error(this,D):this.trigger("error",this,D,k);return false}return true}});
n.Collection=function(g,k){k||(k={});if(k.comparator){this.comparator=k.comparator;delete k.comparator}this._boundOnModelEvent=Q.bind(this._onModelEvent,this);this._reset();g&&this.refresh(g,{silent:true});this.initialize(g,k)};Q.extend(n.Collection.prototype,n.Events,{model:n.Model,initialize:function(){},toJSON:function(){return this.map(function(g){return g.toJSON()})},add:function(g,k){if(Q.isArray(g))for(var D=0,H=g.length;D<H;D++)this._add(g[D],k);else this._add(g,k);return this},remove:function(g,
k){if(Q.isArray(g))for(var D=0,H=g.length;D<H;D++)this._remove(g[D],k);else this._remove(g,k);return this},get:function(g){if(g==null)return null;return this._byId[g.id!=null?g.id:g]},getByCid:function(g){return g&&this._byCid[g.cid||g]},at:function(g){return this.models[g]},sort:function(g){g||(g={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");this.models=this.sortBy(this.comparator);g.silent||this.trigger("refresh",this,g);return this},pluck:function(g){return Q.map(this.models,
function(k){return k.get(g)})},refresh:function(g,k){g||(g=[]);k||(k={});this._reset();this.add(g,{silent:true});k.silent||this.trigger("refresh",this,k);return this},fetch:function(g){g||(g={});var k=this,D=v(g.error,k,g);(this.sync||n.sync)("read",this,function(H){k.refresh(k.parse(H));g.success&&g.success(k,H)},D);return this},create:function(g,k){var D=this;k||(k={});if(g instanceof n.Model)g.collection=D;else g=new this.model(g,{collection:D});return g.save(null,{success:function(H,W){D.add(H);
k.success&&k.success(H,W)},error:k.error})},parse:function(g){return g},chain:function(){return Q(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_add:function(g,k){k||(k={});g instanceof n.Model||(g=new this.model(g,{collection:this}));var D=this.getByCid(g);if(D)throw Error(["Can't add the same model to a set twice",D.id]);this._byId[g.id]=g;this._byCid[g.cid]=g;g.collection=this;this.models.splice(this.comparator?this.sortedIndex(g,this.comparator):
this.length,0,g);g.bind("all",this._boundOnModelEvent);this.length++;k.silent||g.trigger("add",g,this,k);return g},_remove:function(g,k){k||(k={});g=this.getByCid(g)||this.get(g);if(!g)return null;delete this._byId[g.id];delete this._byCid[g.cid];delete g.collection;this.models.splice(this.indexOf(g),1);this.length--;k.silent||g.trigger("remove",g,this,k);g.unbind("all",this._boundOnModelEvent);return g},_onModelEvent:function(g,k){if(g==="change:id"){delete this._byId[k.previous("id")];this._byId[k.id]=
k}this.trigger.apply(this,arguments)}});Q.each(["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty"],function(g){n.Collection.prototype[g]=function(){return Q[g].apply(Q,[this.models].concat(Q.toArray(arguments)))}});n.Controller=function(g){g||(g={});if(g.routes)this.routes=g.routes;this._bindRoutes();
this.initialize(g)};var J=/:([\w\d]+)/g,V=/\*([\w\d]+)/g;Q.extend(n.Controller.prototype,n.Events,{initialize:function(){},route:function(g,k,D){n.history||(n.history=new n.History);Q.isRegExp(g)||(g=this._routeToRegExp(g));n.history.route(g,Q.bind(function(H){H=this._extractParameters(g,H);D.apply(this,H);this.trigger.apply(this,["route:"+k].concat(H))},this))},saveLocation:function(g){n.history.saveLocation(g)},_bindRoutes:function(){if(this.routes)for(var g in this.routes){var k=this.routes[g];
this.route(g,k,this[k])}},_routeToRegExp:function(g){g=g.replace(J,"([^/]*)").replace(V,"(.*?)");return RegExp("^"+g+"$")},_extractParameters:function(g,k){return g.exec(k).slice(1)}});n.History=function(){this.handlers=[];this.fragment=this.getFragment();Q.bindAll(this,"checkUrl")};var p=/^#*/;Q.extend(n.History.prototype,{interval:50,getFragment:function(g){return(g||window.location).hash.replace(p,"")},start:function(){var g=document.documentMode;if(g=S.browser.msie&&(!g||g<=7))this.iframe=S('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;
"onhashchange"in window&&!g?S(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval);return this.loadUrl()},route:function(g,k){this.handlers.push({route:g,callback:k})},checkUrl:function(){var g=this.getFragment();if(g==this.fragment&&this.iframe)g=this.getFragment(this.iframe.location);if(g==this.fragment||g==decodeURIComponent(this.fragment))return false;if(this.iframe)window.location.hash=this.iframe.location.hash=g;this.loadUrl()},loadUrl:function(){var g=this.fragment=
this.getFragment();return Q.any(this.handlers,function(k){if(k.route.test(g)){k.callback(g);return true}})},saveLocation:function(g){g=(g||"").replace(p,"");if(this.fragment!=g){window.location.hash=this.fragment=g;if(this.iframe&&g!=this.getFragment(this.iframe.location)){this.iframe.document.open().close();this.iframe.location.hash=g}}}});n.View=function(g){this._configure(g||{});this._ensureElement();this.delegateEvents();this.initialize(g)};var E=/^(\w+)\s*(.*)$/;Q.extend(n.View.prototype,n.Events,
{tagName:"div",$:function(g){return S(g,this.el)},initialize:function(){},render:function(){return this},remove:function(){S(this.el).remove();return this},make:function(g,k,D){g=document.createElement(g);k&&S(g).attr(k);D&&S(g).html(D);return g},delegateEvents:function(g){if(g||(g=this.events)){S(this.el).unbind();for(var k in g){var D=g[k],H=k.match(E),W=H[1];H=H[2];D=Q.bind(this[D],this);H===""?S(this.el).bind(W,D):S(this.el).delegate(H,W,D)}}},_configure:function(g){if(this.options)g=Q.extend({},
this.options,g);if(g.model)this.model=g.model;if(g.collection)this.collection=g.collection;if(g.el)this.el=g.el;if(g.id)this.id=g.id;if(g.className)this.className=g.className;if(g.tagName)this.tagName=g.tagName;this.options=g},_ensureElement:function(){if(!this.el){var g={};if(this.id)g.id=this.id;if(this.className)g["class"]=this.className;this.el=this.make(this.tagName,g)}}});var M=function(g,k){var D=h(this,g,k);D.extend=M;return D};n.Model.extend=n.Collection.extend=n.Controller.extend=n.View.extend=
M;var w={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};n.sync=function(g,k,D,H){var W=w[g];g=g==="create"||g==="update"?JSON.stringify(k.toJSON()):null;k={url:m(k),type:W,contentType:"application/json",data:g,dataType:"json",processData:false,success:D,error:H};if(n.emulateJSON){k.contentType="application/x-www-form-urlencoded";k.processData=true;k.data=g?{model:g}:{}}if(n.emulateHTTP)if(W==="PUT"||W==="DELETE"){if(n.emulateJSON)k.data._method=W;k.type="POST";k.beforeSend=function(T){T.setRequestHeader("X-HTTP-Method-Override",
W)}}S.ajax(k)};var G=function(){},h=function(g,k,D){var H;H=k&&k.hasOwnProperty("constructor")?k.constructor:function(){return g.apply(this,arguments)};G.prototype=g.prototype;H.prototype=new G;k&&Q.extend(H.prototype,k);D&&Q.extend(H,D);H.prototype.constructor=H;H.__super__=g.prototype;return H},m=function(g){if(!(g&&g.url))throw Error("A 'url' property or function must be specified");return Q.isFunction(g.url)?g.url():g.url},v=function(g,k,D){return function(H){g?g(k,H):k.trigger("error",k,H,D)}}})();/*
 
 JavaScript Debug - v0.4 - 6/22/2010
 http://benalman.com/projects/javascript-debug-console-log/

 Copyright (c) 2010 "Cowboy" Ben Alman
 Dual licensed under the MIT and GPL licenses.
 http://benalman.com/about/license/

 With lots of help from Paul Irish!
 http://paulirish.com/
*/
window.debug=function(){function n(v){if(p&&(E||!J||!J.log))p.apply(Q,v)}for(var Q=this,S=Array.prototype.slice,J=Q.console,V={},p,E,M=9,w=["error","warn","info","debug","log"],G="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),h=G.length,m=[];--h>=0;)(function(v){V[v]=function(){M!==0&&J&&J[v]&&J[v].apply(J,arguments)}})(G[h]);for(h=w.length;--h>=0;)(function(v,g){V[g]=function(){var k=S.call(arguments),D=[g].concat(k);
m.push(D);n(D);if(J&&(M>0?M>v:w.length+M<=v))J.firebug?J[g].apply(Q,k):J[g]?J[g](k):J.log(k)}})(h,w[h]);V.setLevel=function(v){M=typeof v==="number"?v:9};V.setCallback=function(){var v=S.call(arguments),g=m.length,k=g;p=v.shift()||null;E=typeof v[0]==="boolean"?v.shift():false;for(k-=typeof v[0]==="number"?v.shift():g;k<g;)n(m[k++])};return V}();/*

 jQuery Templates Plugin 1.0.0pre
 http://github.com/jquery/jquery-tmpl
 Requires jQuery 1.4.2

 Copyright Software Freedom Conservancy, Inc.
 Dual licensed under the MIT or GPL Version 2 licenses.
 http://jquery.org/license
*/
(function(n){function Q(o,x,B,F){F={data:F||F===0||F===false?F:x?x.data:{},_wrap:x?x._wrap:null,tmpl:null,parent:x||null,nodes:[],calls:w,nest:G,wrap:h,html:m,update:v};o&&n.extend(F,o,{nodes:[],parent:x});if(B){F.tmpl=B;F._ctnt=F._ctnt||F.tmpl(n,F);F.key=++ea;(A.length?W:H)[ea]=F}return F}function S(o,x,B){var F;B=B?n.map(B,function(j){return typeof j==="string"?o.key?j.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+k+'="'+o.key+'" $2'):j:S(j,o,j._ctnt)}):o;if(x)return B;B=B.join("");
B.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(j,q,y,C){F=n(y).get();M(F);if(q)F=J(q).concat(F);if(C)F=F.concat(J(C))});return F?F:J(B)}function J(o){var x=document.createElement("div");x.innerHTML=o;return n.makeArray(x.childNodes)}function V(o){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+n.trim(o).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(x,B,F,j,q,y,C){x=n.tmpl.tag[F];if(!x)throw"Unknown template tag: "+F;F=x._default||[];if(y&&!/\w$/.test(q)){q+=y;y=""}if(q){q=E(q);C=C?","+E(C)+")":y?")":"";C=y?q.indexOf(".")>-1?q+E(y):"("+q+").call($item"+C:q;y=y?C:"(typeof("+q+")==='function'?("+q+").call($item):("+q+"))"}else y=C=F.$1||"null";j=E(j);return"');"+x[B?"close":"open"].split("$notnull_1").join(q?"typeof("+q+")!=='undefined' && ("+q+")!=null":"true").split("$1a").join(y).split("$1").join(C).split("$2").join(j||F.$2||"")+"__.push('"})+
"');}return __;")}function p(o,x){o._wrap=S(o,true,n.isArray(x)?x:[D.test(x)?x:n(x).html()]).join("")}function E(o){return o?o.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function M(o){function x(P){function Z(fa){fa+=B;da=q[fa]=q[fa]||Q(da,H[da.parent.key+B]||da.parent)}var ka,$=P,da,la;if(la=P.getAttribute(k)){for(;$.parentNode&&($=$.parentNode).nodeType===1&&!(ka=$.getAttribute(k)););if(ka!==la){$=$.parentNode?$.nodeType===11?0:$.getAttribute(k)||0:0;if(!(da=H[la])){da=W[la];da=Q(da,H[$]||W[$]);
da.key=++ea;H[ea]=da}ha&&Z(la)}P.removeAttribute(k)}else if(ha&&(da=n.data(P,"tmplItem"))){Z(da.key);H[da.key]=da;$=($=n.data(P.parentNode,"tmplItem"))?$.key:0}if(da){for(ka=da;ka&&ka.key!=$;){ka.nodes.push(P);ka=ka.parent}delete da._ctnt;delete da._wrap;n.data(P,"tmplItem",da)}}var B="_"+ha,F,j,q={},y,C,N;y=0;for(C=o.length;y<C;y++)if((F=o[y]).nodeType===1){j=F.getElementsByTagName("*");for(N=j.length-1;N>=0;N--)x(j[N]);x(F)}}function w(o,x,B,F){if(!o)return A.pop();A.push({_:o,tmpl:x,item:this,
data:B,options:F})}function G(o,x,B){return n.tmpl(n.template(o),x,B,this)}function h(o,x){var B=o.options||{};B.wrapped=x;return n.tmpl(n.template(o.tmpl),o.data,B,o.item)}function m(o,x){var B=this._wrap;return n.map(n(n.isArray(B)?B.join(""):B).filter(o||"*"),function(F){if(x)F=F.innerText||F.textContent;else{var j;if(!(j=F.outerHTML)){j=document.createElement("div");j.appendChild(F.cloneNode(true));j=j.innerHTML}F=j}return F})}function v(){var o=this.nodes;n.tmpl(null,null,null,this).insertBefore(o[0]);
n(o).remove()}var g=n.fn.domManip,k="_tmplitem",D=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,H={},W={},T,z={key:0,data:{}},ea=0,ha=0,A=[];n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(o,x){n.fn[o]=function(B){var F=[];B=n(B);var j,q,y;j=this.length===1&&this[0].parentNode;T=H||{};if(j&&j.nodeType===11&&j.childNodes.length===1&&B.length===1){B[x](this[0]);F=this}else{q=0;for(y=B.length;q<y;q++){ha=q;j=(q>0?this.clone(true):this).get();
n(B[q])[x](j);F=F.concat(j)}ha=0;F=this.pushStack(F,o,B.selector)}B=T;T=null;n.tmpl.complete(B);return F}});n.fn.extend({tmpl:function(o,x,B){return n.tmpl(this[0],o,x,B)},tmplItem:function(){return n.tmplItem(this[0])},template:function(o){return n.template(o,this[0])},domManip:function(o,x,B){if(o[0]&&n.isArray(o[0])){for(var F=n.makeArray(arguments),j=o[0],q=j.length,y=0,C;y<q&&!(C=n.data(j[y++],"tmplItem")););if(C&&ha)F[2]=function(N){n.tmpl.afterManip(this,N,B)};g.apply(this,F)}else g.apply(this,
arguments);ha=0;T||n.tmpl.complete(H);return this}});n.extend({tmpl:function(o,x,B,F){var j=!F;if(j){F=z;o=n.template[o]||n.template(null,o);W={}}else if(!o){o=F.tmpl;H[F.key]=F;F.nodes=[];F.wrapped&&p(F,F.wrapped);return n(S(F,null,F.tmpl(n,F)))}if(!o)return[];if(typeof x==="function")x=x.call(F||{});B&&B.wrapped&&p(B,B.wrapped);x=n.isArray(x)?n.map(x,function(q){return q?Q(B,F,o,q):null}):[Q(B,F,o,x)];return j?n(S(F,null,x)):x},tmplItem:function(o){var x;if(o instanceof n)o=o[0];for(;o&&o.nodeType===
1&&!(x=n.data(o,"tmplItem"))&&(o=o.parentNode););return x||z},template:function(o,x){if(x){if(typeof x==="string")x=V(x);else if(x instanceof n)x=x[0]||{};if(x.nodeType)x=n.data(x,"tmpl")||n.data(x,"tmpl",V(x.innerHTML));return typeof o==="string"?n.template[o]=x:x}return o?typeof o!=="string"?n.template(null,o):n.template[o]||n.template(null,D.test(o)?o:n(o)):null},encode:function(o){return(""+o).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});
n.extend(n.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},
"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){H={}},afterManip:function(o,x,B){var F=x.nodeType===11?n.makeArray(x.childNodes):x.nodeType===1?[x]:[];B.call(o,x);M(F);ha++}})})(jQuery);/*

 Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
 Licensed under the MIT License (LICENSE.txt).

 Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 Thanks to: Seamus Leahy for adding deltaX and deltaY

 Version: 3.0.4

 Requires: 1.2.2+
*/
(function(n){function Q(J){var V=J||window.event,p=[].slice.call(arguments,1),E=0,M=0,w=0;J=n.event.fix(V);J.type="mousewheel";if(J.wheelDelta)E=J.wheelDelta/120;if(J.detail)E=-J.detail/3;w=E;if(V.axis!==undefined&&V.axis===V.HORIZONTAL_AXIS){w=0;M=-1*E}if(V.wheelDeltaY!==undefined)w=V.wheelDeltaY/120;if(V.wheelDeltaX!==undefined)M=-1*V.wheelDeltaX/120;p.unshift(J,E,M,w);return n.event.handle.apply(this,p)}var S=["DOMMouseScroll","mousewheel"];n.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var J=
S.length;J;)this.addEventListener(S[--J],Q,false);else this.onmousewheel=Q},teardown:function(){if(this.removeEventListener)for(var J=S.length;J;)this.removeEventListener(S[--J],Q,false);else this.onmousewheel=null}};n.fn.extend({mousewheel:function(J){return J?this.bind("mousewheel",J):this.trigger("mousewheel")},unmousewheel:function(J){return this.unbind("mousewheel",J)}})})(jQuery);/*

 jQuery.UI.iPad plugin
 Copyright (c) 2010 Stephen von Takach
 licensed under MIT.
 Date: 27/8/2010

 Project Home: 
 http://code.google.com/p/jquery-ui-for-ipad-and-iphone/
*/
(function(n){function Q(){if(w){window.clearTimeout(h);w=false;G=null}}function S(v){if(!w){w=true;G=v.changedTouches[0];h=window.setTimeout(function(){w=false;var g=G,k=document.createEvent("MouseEvent");k.initMouseEvent("mouseup",true,true,window,1,g.screenX,g.screenY,g.clientX,g.clientY,false,false,false,false,0,null);g.target.dispatchEvent(k);k=document.createEvent("MouseEvent");k.initMouseEvent("mousedown",true,true,window,1,g.screenX,g.screenY,g.clientX,g.clientY,false,false,false,false,2,null);
g.target.dispatchEvent(k);k=document.createEvent("MouseEvent");k.initMouseEvent("contextmenu",true,true,window,1,g.screenX+50,g.screenY+5,g.clientX+50,g.clientY+5,false,false,false,false,2,null);g.target.dispatchEvent(k);m=true;G=null},800)}}function J(v){var g=v.changedTouches[0],k="mouseover",D=document.createEvent("MouseEvent");D.initMouseEvent(k,true,true,window,1,g.screenX,g.screenY,g.clientX,g.clientY,false,false,false,false,0,null);g.target.dispatchEvent(D);k="mousedown";D=document.createEvent("MouseEvent");
D.initMouseEvent(k,true,true,window,1,g.screenX,g.screenY,g.clientX,g.clientY,false,false,false,false,0,null);g.target.dispatchEvent(D);if(E){window.clearTimeout(M);if(g.target==p){p=null;E=false;k="click";D=document.createEvent("MouseEvent");D.initMouseEvent(k,true,true,window,1,g.screenX,g.screenY,g.clientX,g.clientY,false,false,false,false,0,null);g.target.dispatchEvent(D);k="dblclick";D=document.createEvent("MouseEvent");D.initMouseEvent(k,true,true,window,1,g.screenX,g.screenY,g.clientX,g.clientY,
false,false,false,false,0,null);g.target.dispatchEvent(D)}else{p=g.target;E=true;M=window.setTimeout(function(){E=false},600);S(v)}}else{p=g.target;E=true;M=window.setTimeout(function(){E=false},600);S(v)}}function V(v){var g="";if(!(v.touches.length>1)){switch(v.type){case "gesturestart":alert("gesturestart");v.preventDefault();break;case "touchstart":if(n(v.changedTouches[0].target).is("select"))return;J(v);v.preventDefault();return false;case "touchmove":Q();g="mousemove";v.preventDefault();break;
case "touchend":if(m){m=false;v.preventDefault();return false}Q();g="mouseup";break;default:return}v=v.changedTouches[0];var k=document.createEvent("MouseEvent");k.initMouseEvent(g,true,true,window,1,v.screenX,v.screenY,v.clientX,v.clientY,false,false,false,false,0,null);v.target.dispatchEvent(k);if(g=="mouseup"&&E&&v.target==p){k=document.createEvent("MouseEvent");k.initMouseEvent("click",true,true,window,1,v.screenX,v.screenY,v.clientX,v.clientY,false,false,false,false,0,null);v.target.dispatchEvent(k)}}}
n.extend(n.support,{touch:typeof Touch=="object"});n.fn.addTouch=function(){n.support.touch&&this.each(function(v,g){g.addEventListener("touchstart",V,false);g.addEventListener("touchmove",V,false);g.addEventListener("touchend",V,false);g.addEventListener("touchcancel",V,false)})};var p=null,E=false,M=null,w=false,G=null,h=null,m=false})(jQuery);/*

 Raphael 1.5.2 - JavaScript Vector Library

 Copyright (c) 2010 Dmitry Baranovskiy (http://raphaeljs.com)
 Licensed under the MIT (http://raphaeljs.com/license.html) license.
*/
(function(){function n(){if(n.is(arguments[0],P)){for(var a=arguments[0],c=Na[H](n,a.splice(0,3+n.is(a[0],N))),d=c.set(),f=0,i=a[o];f<i;f++){var e=a[f]||{};M[h](e.type)&&d[$](c[e.type]().attr(e))}return d}return Na[H](n,arguments)}function Q(){for(var a=[],c=0;c<32;c++)a[c]=(~~(B.random()*16))[Z](16);a[12]=4;a[16]=(a[16]&3|8)[Z](16);return"r-"+a[A]("")}function S(a,c,d){function f(){var i=Array[G].slice.call(arguments,0),e=i[A]("\u25ba"),l=f.cache=f.cache||{},r=f.count=f.count||[];if(l[h](e))return d?
d(l[e]):l[e];r[o]>=1E3&&delete l[r.shift()];r[$](e);l[e]=a[H](c,i);return d?d(l[e]):l[e]}return f}function J(){return this.x+T+this.y}function V(a){return function(c,d,f,i){var e={back:a};n.is(f,"function")?i=f:e.rot=f;c&&c.constructor==ia&&(c=c.attrs.path);c&&(e.along=c);return this.animate(e,d,i)}}function p(a,c,d,f,i,e){function l(R,ca){var U,O,Y,ja;Y=R;for(O=0;O<8;O++){ja=((u*Y+s)*Y+r)*Y-R;if(q(ja)<ca)return Y;U=(3*u*Y+2*s)*Y+r;if(q(U)<1.0E-6)break;Y-=ja/U}U=0;O=1;Y=R;if(Y<U)return U;if(Y>O)return O;
for(;U<O;){ja=((u*Y+s)*Y+r)*Y;if(q(ja-R)<ca)break;R>ja?U=Y:O=Y;Y=(O-U)/2+U}return Y}var r=3*c,s=3*(f-c)-r,u=1-r-s,I=3*d,K=3*(i-d)-I,L=1-I-K;return function(R,ca){var U=l(R,ca);return((L*U+K)*U+I)*U}(a,1/(200*e))}n.version="1.5.2";var E=/[, ]+/,M={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},w=/\{(\d+)\}/g,G="prototype",h="hasOwnProperty",m=document,v=window,g={was:Object[G][h].call(v,"Raphael"),is:v.Raphael},k=function(){this.customAttributes={}},D,H="apply",W="createTouch"in m,T=" ",z=String,
ea="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend".split(T),ha={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},A="join",o="length",x=z[G].toLowerCase,B=Math,F=B.max,j=B.min,q=B.abs,y=B.pow,C=B.PI,N="number",P="array",Z="toString",ka=Object[G][Z],$="push",da=/^url\(['"]?([^\)]+?)['"]?\)$/i,la=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,
fa={NaN:1,Infinity:1,"-Infinity":1},ra=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,aa=B.round,X=parseFloat,na=parseInt,wa=z[G].toUpperCase,Ea={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt",
"stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},Oa={along:"along",blur:N,"clip-rect":"csv",cx:N,cy:N,fill:"colour","fill-opacity":N,"font-size":N,height:N,opacity:N,path:"path",r:N,rotation:"csv",rx:N,ry:N,scale:"csv",stroke:"colour","stroke-opacity":N,"stroke-width":N,translation:"csv",width:N,x:N,y:N},ub=/^(from|to|\d+%?)$/,Pa=/\s*,\s*/,vb={hs:1,rg:1},wb=/,?([achlmqrstvxz]),?/gi,
xb=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,yb=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,Za=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,zb=function(a,c){return a.key-c.key};n.type=v.SVGAngle||m.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(n.type=="VML"){var ta=m.createElement("div");ta.innerHTML='<v:shape adj="1"/>';ta=ta.firstChild;ta.style.behavior="url(#default#VML)";if(!(ta&&typeof ta.adj=="object"))return n.type=null;ta=null}n.svg=
!(n.vml=n.type=="VML");k[G]=n[G];D=k[G];n._id=0;n._oid=0;n.fn={};n.is=function(a,c){c=x.call(c);if(c=="finite")return!fa[h](+a);return c=="null"&&a===null||c==typeof a||c=="object"&&a===Object(a)||c=="array"&&Array.isArray&&Array.isArray(a)||ka.call(a).slice(8,-1).toLowerCase()==c};n.angle=function(a,c,d,f,i,e){if(i==null){a-=d;c-=f;if(!a&&!c)return 0;return((a<0)*180+B.atan(-c/-a)*180/C+360)%360}return n.angle(a,c,i,e)-n.angle(d,f,i,e)};n.rad=function(a){return a%360*C/180};n.deg=function(a){return a*
180/C%360};n.snapTo=function(a,c,d){d=n.is(d,"finite")?d:10;if(n.is(a,P))for(var f=a.length;f--;){if(q(a[f]-c)<=d)return a[f]}else{a=+a;f=c%a;if(f<d)return c-f;if(f>a-d)return c-f+a}return c};n.setWindow=function(a){v=a;m=v.document};var Fa=function(a){if(n.vml){var c=/^\s+|\s+$/g,d;try{var f=new ActiveXObject("htmlfile");f.write("<body>");f.close();d=f.body}catch(i){d=createPopup().document.body}var e=d.createTextRange();Fa=S(function(r){try{d.style.color=z(r).replace(c,"");var s=e.queryCommandValue("ForeColor");
return"#"+("000000"+((s&255)<<16|s&65280|(s&16711680)>>>16)[Z](16)).slice(-6)}catch(u){return"none"}})}else{var l=m.createElement("i");l.title="Rapha\u00ebl Colour Picker";l.style.display="none";m.body.appendChild(l);Fa=S(function(r){l.style.color=r;return m.defaultView.getComputedStyle(l,"").getPropertyValue("color")})}return Fa(a)},$a=function(){return"hsb("+[this.h,this.s,this.b]+")"},Ab=function(){return"hsl("+[this.h,this.s,this.l]+")"},Bb=function(){return this.hex};n.hsb2rgb=function(a,c,d,
f){if(n.is(a,"object")&&"h"in a&&"s"in a&&"b"in a){d=a.b;c=a.s;a=a.h;f=a.o}return n.hsl2rgb(a,c,d/2,f)};n.hsl2rgb=function(a,c,d,f){if(n.is(a,"object")&&"h"in a&&"s"in a&&"l"in a){d=a.l;c=a.s;a=a.h}if(a>1||c>1||d>1){a/=360;c/=100;d/=100}var i={},e=["r","g","b"],l;if(c){d<0.5?l=d*(1+c):l=d+c-d*c;c=2*d-l;for(var r=0;r<3;r++){d=a+1/3*-(r-1);d<0&&d++;d>1&&d--;d*6<1?i[e[r]]=c+(l-c)*6*d:d*2<1?i[e[r]]=l:d*3<2?i[e[r]]=c+(l-c)*(2/3-d)*6:i[e[r]]=c}}else i={r:d,g:d,b:d};i.r*=255;i.g*=255;i.b*=255;i.hex="#"+
(16777216|i.b|i.g<<8|i.r<<16).toString(16).slice(1);n.is(f,"finite")&&(i.opacity=f);i.toString=Bb;return i};n.rgb2hsb=function(a,c,d){if(c==null&&n.is(a,"object")&&"r"in a&&"g"in a&&"b"in a){d=a.b;c=a.g;a=a.r}if(c==null&&n.is(a,"string")){d=n.getRGB(a);a=d.r;c=d.g;d=d.b}if(a>1||c>1||d>1){a/=255;c/=255;d/=255}var f=F(a,c,d),i=j(a,c,d),e;if(i==f)return{h:0,s:0,b:f,toString:$a};i=f-i;a==f?e=(c-d)/i:c==f?e=2+(d-a)/i:e=4+(a-c)/i;e/=6;e<0&&e++;e>1&&e--;return{h:e,s:i/f,b:f,toString:$a}};n.rgb2hsl=function(a,
c,d){if(c==null&&n.is(a,"object")&&"r"in a&&"g"in a&&"b"in a){d=a.b;c=a.g;a=a.r}if(c==null&&n.is(a,"string")){d=n.getRGB(a);a=d.r;c=d.g;d=d.b}if(a>1||c>1||d>1){a/=255;c/=255;d/=255}var f=F(a,c,d),i=j(a,c,d),e,l=(f+i)/2;if(i==f)a={h:0,s:0,l:l};else{var r=f-i;a==f?e=(c-d)/r:c==f?e=2+(d-a)/r:e=4+(a-c)/r;e/=6;e<0&&e++;e>1&&e--;a={h:e,s:l<0.5?r/(f+i):r/(2-f-i),l:l}}a.toString=Ab;return a};n._path2string=function(){return this.join(",").replace(wb,"$1")};n.getRGB=S(function(a){if(!a||(a=z(a)).indexOf("-")+
1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if(a=="none")return{r:-1,g:-1,b:-1,hex:"none"};!(vb[h](a.toLowerCase().substring(0,2))||a.charAt()=="#")&&(a=Fa(a));var c,d,f,i,e;if(a=a.match(la)){if(a[2]){f=na(a[2].substring(5),16);d=na(a[2].substring(3,5),16);c=na(a[2].substring(1,3),16)}if(a[3]){f=na((e=a[3].charAt(3))+e,16);d=na((e=a[3].charAt(2))+e,16);c=na((e=a[3].charAt(1))+e,16)}if(a[4]){e=a[4].split(Pa);c=X(e[0]);e[0].slice(-1)=="%"&&(c*=2.55);d=X(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);f=X(e[2]);
e[2].slice(-1)=="%"&&(f*=2.55);a[1].toLowerCase().slice(0,4)=="rgba"&&(i=X(e[3]));e[3]&&e[3].slice(-1)=="%"&&(i/=100)}if(a[5]){e=a[5].split(Pa);c=X(e[0]);e[0].slice(-1)=="%"&&(c*=2.55);d=X(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);f=X(e[2]);e[2].slice(-1)=="%"&&(f*=2.55);(e[0].slice(-3)=="deg"||e[0].slice(-1)=="\u00b0")&&(c/=360);a[1].toLowerCase().slice(0,4)=="hsba"&&(i=X(e[3]));e[3]&&e[3].slice(-1)=="%"&&(i/=100);return n.hsb2rgb(c,d,f,i)}if(a[6]){e=a[6].split(Pa);c=X(e[0]);e[0].slice(-1)=="%"&&(c*=
2.55);d=X(e[1]);e[1].slice(-1)=="%"&&(d*=2.55);f=X(e[2]);e[2].slice(-1)=="%"&&(f*=2.55);(e[0].slice(-3)=="deg"||e[0].slice(-1)=="\u00b0")&&(c/=360);a[1].toLowerCase().slice(0,4)=="hsla"&&(i=X(e[3]));e[3]&&e[3].slice(-1)=="%"&&(i/=100);return n.hsl2rgb(c,d,f,i)}a={r:c,g:d,b:f};a.hex="#"+(16777216|f|d<<8|c<<16).toString(16).slice(1);n.is(i,"finite")&&(a.opacity=i);return a}return{r:-1,g:-1,b:-1,hex:"none",error:1}},n);n.getColor=function(a){a=this.getColor.start=this.getColor.start||{h:0,s:1,b:a||0.75};
var c=this.hsb2rgb(a.h,a.s,a.b);a.h+=0.075;if(a.h>1){a.h=0;a.s-=0.2;a.s<=0&&(this.getColor.start={h:0,s:1,b:a.b})}return c.hex};n.getColor.reset=function(){delete this.start};n.parsePathString=S(function(a){if(!a)return null;var c={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},d=[];n.is(a,P)&&n.is(a[0],P)&&(d=Ga(a));d[o]||z(a).replace(xb,function(f,i,e){var l=[];f=x.call(i);e.replace(yb,function(r,s){s&&l[$](+s)});if(f=="m"&&l[o]>2){d[$]([i].concat(l.splice(0,2)));f="l";i=i=="m"?"l":"L"}for(;l[o]>=c[f];){d[$]([i].concat(l.splice(0,
c[f])));if(!c[f])break}});d[Z]=n._path2string;return d});n.findDotsAtSegment=function(a,c,d,f,i,e,l,r,s){var u=1-s,I=y(u,3)*a+y(u,2)*3*s*d+u*3*s*s*i+y(s,3)*l;u=y(u,3)*c+y(u,2)*3*s*f+u*3*s*s*e+y(s,3)*r;var K=a+2*s*(d-a)+s*s*(i-2*d+a),L=c+2*s*(f-c)+s*s*(e-2*f+c),R=d+2*s*(i-d)+s*s*(l-2*i+d),ca=f+2*s*(e-f)+s*s*(r-2*e+f);a=(1-s)*a+s*d;c=(1-s)*c+s*f;i=(1-s)*i+s*l;e=(1-s)*e+s*r;r=90-B.atan((K-R)/(L-ca))*180/C;(K>R||L<ca)&&(r+=180);return{x:I,y:u,m:{x:K,y:L},n:{x:R,y:ca},start:{x:a,y:c},end:{x:i,y:e},alpha:r}};
var Ia=S(function(a){if(!a)return{x:0,y:0,width:0,height:0};a=Ha(a);for(var c=0,d=0,f=[],i=[],e,l=0,r=a[o];l<r;l++){e=a[l];if(e[0]=="M"){c=e[1];d=e[2];f[$](c);i[$](d)}else{c=Cb(c,d,e[1],e[2],e[3],e[4],e[5],e[6]);f=f.concat(c.min.x,c.max.x);i=i.concat(c.min.y,c.max.y);c=e[5];d=e[6]}}a=j[H](0,f);e=j[H](0,i);return{x:a,y:e,width:F[H](0,f)-a,height:F[H](0,i)-e}}),Ga=function(a){var c=[];if(!n.is(a,P)||!n.is(a&&a[0],P))a=n.parsePathString(a);for(var d=0,f=a[o];d<f;d++){c[d]=[];for(var i=0,e=a[d][o];i<
e;i++)c[d][i]=a[d][i]}c[Z]=n._path2string;return c},Qa=S(function(a){if(!n.is(a,P)||!n.is(a&&a[0],P))a=n.parsePathString(a);var c=[],d=0,f=0,i=0,e=0,l=0;if(a[0][0]=="M"){d=a[0][1];f=a[0][2];i=d;e=f;l++;c[$](["M",d,f])}for(var r=a[o];l<r;l++){var s=c[l]=[],u=a[l];if(u[0]!=x.call(u[0])){s[0]=x.call(u[0]);switch(s[0]){case "a":s[1]=u[1];s[2]=u[2];s[3]=u[3];s[4]=u[4];s[5]=u[5];s[6]=+(u[6]-d).toFixed(3);s[7]=+(u[7]-f).toFixed(3);break;case "v":s[1]=+(u[1]-f).toFixed(3);break;case "m":i=u[1];e=u[2];default:for(var I=
1,K=u[o];I<K;I++)s[I]=+(u[I]-(I%2?d:f)).toFixed(3)}}else{c[l]=[];if(u[0]=="m"){i=u[1]+d;e=u[2]+f}s=0;for(I=u[o];s<I;s++)c[l][s]=u[s]}u=c[l][o];switch(c[l][0]){case "z":d=i;f=e;break;case "h":d+=+c[l][u-1];break;case "v":f+=+c[l][u-1];break;default:d+=+c[l][u-2];f+=+c[l][u-1]}}c[Z]=n._path2string;return c},0,Ga),Aa=S(function(a){if(!n.is(a,P)||!n.is(a&&a[0],P))a=n.parsePathString(a);var c=[],d=0,f=0,i=0,e=0,l=0;if(a[0][0]=="M"){d=+a[0][1];f=+a[0][2];i=d;e=f;l++;c[0]=["M",d,f]}for(var r=a[o];l<r;l++){var s=
c[l]=[],u=a[l];if(u[0]!=wa.call(u[0])){s[0]=wa.call(u[0]);switch(s[0]){case "A":s[1]=u[1];s[2]=u[2];s[3]=u[3];s[4]=u[4];s[5]=u[5];s[6]=+(u[6]+d);s[7]=+(u[7]+f);break;case "V":s[1]=+u[1]+f;break;case "H":s[1]=+u[1]+d;break;case "M":i=+u[1]+d;e=+u[2]+f;default:for(var I=1,K=u[o];I<K;I++)s[I]=+u[I]+(I%2?d:f)}}else{I=0;for(K=u[o];I<K;I++)c[l][I]=u[I]}switch(s[0]){case "Z":d=i;f=e;break;case "H":d=s[1];break;case "V":f=s[1];break;case "M":i=c[l][c[l][o]-2];e=c[l][c[l][o]-1];default:d=c[l][c[l][o]-2];f=
c[l][c[l][o]-1]}}c[Z]=n._path2string;return c},null,Ga),ab=function(a,c,d,f,i,e){var l=1/3,r=2/3;return[l*a+r*d,l*c+r*f,l*i+r*d,l*e+r*f,i,e]},bb=function(a,c,d,f,i,e,l,r,s,u){var I=C*120/180,K=C/180*(+i||0),L=[],R,ca=S(function(oa,pa,ma){var ya=oa*B.cos(ma)-pa*B.sin(ma);oa=oa*B.sin(ma)+pa*B.cos(ma);return{x:ya,y:oa}});if(u){Y=u[0];R=u[1];e=u[2];O=u[3]}else{R=ca(a,c,-K);a=R.x;c=R.y;R=ca(r,s,-K);r=R.x;s=R.y;B.cos(C/180*i);B.sin(C/180*i);R=(a-r)/2;Y=(c-s)/2;O=R*R/(d*d)+Y*Y/(f*f);if(O>1){O=B.sqrt(O);
d*=O;f*=O}O=d*d;var U=f*f;O=(e==l?-1:1)*B.sqrt(q((O*U-O*Y*Y-U*R*R)/(O*Y*Y+U*R*R)));e=O*d*Y/f+(a+r)/2;var O=O*-f*R/d+(c+s)/2,Y=B.asin(((c-O)/f).toFixed(9));R=B.asin(((s-O)/f).toFixed(9));Y=a<e?C-Y:Y;R=r<e?C-R:R;Y<0&&(Y=C*2+Y);R<0&&(R=C*2+R);l&&Y>R&&(Y-=C*2);!l&&R>Y&&(R-=C*2)}if(q(R-Y)>I){L=R;U=r;var ja=s;R=Y+I*(l&&R>Y?1:-1);r=e+d*B.cos(R);s=O+f*B.sin(R);L=bb(r,s,d,f,i,0,l,U,ja,[R,L,e,O])}e=R-Y;i=B.cos(Y);I=B.sin(Y);l=B.cos(R);R=B.sin(R);e=B.tan(e/4);d=4/3*d*e;e*=4/3*f;f=[a,c];a=[a+d*I,c-e*i];c=[r+
d*R,s-e*l];r=[r,s];a[0]=2*f[0]-a[0];a[1]=2*f[1]-a[1];if(u)return[a,c,r].concat(L);L=[a,c,r].concat(L)[A]().split(",");u=[];r=0;for(s=L[o];r<s;r++)u[r]=r%2?ca(L[r-1],L[r],K).y:ca(L[r],L[r+1],K).x;return u},Ja=function(a,c,d,f,i,e,l,r,s){var u=1-s;return{x:y(u,3)*a+y(u,2)*3*s*d+u*3*s*s*i+y(s,3)*l,y:y(u,3)*c+y(u,2)*3*s*f+u*3*s*s*e+y(s,3)*r}},Cb=S(function(a,c,d,f,i,e,l,r){var s=i-2*d+a-(l-2*i+d),u=2*(d-a)-2*(i-d),I=a-d,K=(-u+B.sqrt(u*u-4*s*I))/2/s;s=(-u-B.sqrt(u*u-4*s*I))/2/s;var L=[c,r],R=[a,l];q(K)>
"1e12"&&(K=0.5);q(s)>"1e12"&&(s=0.5);if(K>0&&K<1){K=Ja(a,c,d,f,i,e,l,r,K);R[$](K.x);L[$](K.y)}if(s>0&&s<1){K=Ja(a,c,d,f,i,e,l,r,s);R[$](K.x);L[$](K.y)}s=e-2*f+c-(r-2*e+f);u=2*(f-c)-2*(e-f);I=c-f;K=(-u+B.sqrt(u*u-4*s*I))/2/s;s=(-u-B.sqrt(u*u-4*s*I))/2/s;q(K)>"1e12"&&(K=0.5);q(s)>"1e12"&&(s=0.5);if(K>0&&K<1){K=Ja(a,c,d,f,i,e,l,r,K);R[$](K.x);L[$](K.y)}if(s>0&&s<1){K=Ja(a,c,d,f,i,e,l,r,s);R[$](K.x);L[$](K.y)}return{min:{x:j[H](0,R),y:j[H](0,L)},max:{x:F[H](0,R),y:F[H](0,L)}}}),Ha=S(function(a,c){var d=
Aa(a),f=c&&Aa(c),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},e={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},l=function(U,O){var Y,ja;if(!U)return["C",O.x,O.y,O.x,O.y,O.x,O.y];!(U[0]in{T:1,Q:1})&&(O.qx=O.qy=null);switch(U[0]){case "M":O.X=U[1];O.Y=U[2];break;case "A":U=["C"].concat(bb[H](0,[O.x,O.y].concat(U.slice(1))));break;case "S":Y=O.x+(O.x-(O.bx||O.x));ja=O.y+(O.y-(O.by||O.y));U=["C",Y,ja].concat(U.slice(1));break;case "T":O.qx=O.x+(O.x-(O.qx||O.x));O.qy=O.y+(O.y-(O.qy||O.y));U=["C"].concat(ab(O.x,
O.y,O.qx,O.qy,U[1],U[2]));break;case "Q":O.qx=U[1];O.qy=U[2];U=["C"].concat(ab(O.x,O.y,U[1],U[2],U[3],U[4]));break;case "L":U=["C"].concat([O.x,O.y,U[1],U[2],U[1],U[2]]);break;case "H":U=["C"].concat([O.x,O.y,U[1],O.y,U[1],O.y]);break;case "V":U=["C"].concat([O.x,O.y,O.x,U[1],O.x,U[1]]);break;case "Z":U=["C"].concat([O.x,O.y,O.X,O.Y,O.X,O.Y])}return U},r=function(U,O){if(U[O][o]>7){U[O].shift();for(var Y=U[O];Y[o];)U.splice(O++,0,["C"].concat(Y.splice(0,6)));U.splice(O,1);I=F(d[o],f&&f[o]||0)}},s=
function(U,O,Y,ja,oa){if(U&&O&&U[oa][0]=="M"&&O[oa][0]!="M"){O.splice(oa,0,["M",ja.x,ja.y]);Y.bx=0;Y.by=0;Y.x=U[oa][1];Y.y=U[oa][2];I=F(d[o],f&&f[o]||0)}},u=0,I=F(d[o],f&&f[o]||0);for(;u<I;u++){d[u]=l(d[u],i);r(d,u);f&&(f[u]=l(f[u],e));f&&r(f,u);s(d,f,i,e,u);s(f,d,e,i,u);var K=d[u],L=f&&f[u],R=K[o],ca=f&&L[o];i.x=K[R-2];i.y=K[R-1];i.bx=X(K[R-4])||i.x;i.by=X(K[R-3])||i.y;e.bx=f&&(X(L[ca-4])||e.x);e.by=f&&(X(L[ca-3])||e.y);e.x=f&&L[ca-2];e.y=f&&L[ca-1]}return f?[d,f]:d},null,Ga),cb=S(function(a){for(var c=
[],d=0,f=a[o];d<f;d++){var i={},e=a[d].match(/^([^:]*):?([\d\.]*)/);i.color=n.getRGB(e[1]);if(i.color.error)return null;i.color=i.color.hex;e[2]&&(i.offset=e[2]+"%");c[$](i)}d=1;for(f=c[o]-1;d<f;d++)if(!c[d].offset){a=X(c[d-1].offset||0);e=0;for(i=d+1;i<f;i++)if(c[i].offset){e=c[i].offset;break}if(!e){e=100;i=f}e=X(e);for(e=(e-a)/(i-d+1);d<i;d++){a+=e;c[d].offset=a+"%"}}return c}),db=function(a,c,d,f){if(n.is(a,"string")||n.is(a,"object")){a=n.is(a,"string")?m.getElementById(a):a;if(a.tagName)return c==
null?{container:a,width:a.style.pixelWidth||a.offsetWidth,height:a.style.pixelHeight||a.offsetHeight}:{container:a,width:c,height:d}}else return{container:1,x:a,y:c,width:d,height:f}},Ra=function(a,c){var d=this,f;for(f in c)if(c[h](f)&&!(f in a))switch(typeof c[f]){case "function":(function(i){a[f]=a===d?i:function(){return i[H](d,arguments)}})(c[f]);break;case "object":a[f]=a[f]||{};Ra.call(this,a[f],c[f]);break;default:a[f]=c[f]}},za=function(a,c){a==c.top&&(c.top=a.prev);a==c.bottom&&(c.bottom=
a.next);a.next&&(a.next.prev=a.prev);a.prev&&(a.prev.next=a.next)},eb=function(a,c){if(c.top!==a){za(a,c);a.next=null;a.prev=c.top;c.top.next=a;c.top=a}},fb=function(a,c){if(c.bottom!==a){za(a,c);a.next=c.bottom;a.prev=null;c.bottom.prev=a;c.bottom=a}},gb=function(a,c,d){za(a,d);c==d.top&&(d.top=a);c.next&&(c.next.prev=a);a.next=c.next;a.prev=c;c.next=a},hb=function(a,c,d){za(a,d);c==d.bottom&&(d.bottom=a);c.prev&&(c.prev.next=a);a.prev=c.prev;c.prev=a;a.next=c},ib=function(a){return function(){throw Error("Rapha\u00ebl: you are calling to method \u201c"+
a+"\u201d of removed object");}};n.pathToRelative=Qa;if(n.svg){D.svgns="http://www.w3.org/2000/svg";D.xlink="http://www.w3.org/1999/xlink";aa=function(a){return+a+(~~a===a)*0.5};var ba=function(a,c){if(c)for(var d in c)c[h](d)&&a.setAttribute(d,z(c[d]));else{a=m.createElementNS(D.svgns,a);a.style.webkitTapHighlightColor="rgba(0,0,0,0)";return a}};n[Z]=function(){return"Your browser supports SVG.\nYou are running Rapha\u00ebl "+this.version};var jb=function(a,c){var d=ba("path");c.canvas&&c.canvas.appendChild(d);
d=new ia(d,c);d.type="path";xa(d,{fill:"none",stroke:"#000",path:a});return d},Ba=function(a,c,d){var f="linear",i=0.5,e=0.5,l=a.style;c=z(c).replace(Za,function(I,K,L){f="radial";if(K&&L){i=X(K);e=X(L);I=(e>0.5)*2-1;y(i-0.5,2)+y(e-0.5,2)>0.25&&(e=B.sqrt(0.25-y(i-0.5,2))*I+0.5)&&e!=0.5&&(e=e.toFixed(5)-1.0E-5*I)}return""});c=c.split(/\s*\-\s*/);if(f=="linear"){var r=c.shift();r=-X(r);if(isNaN(r))return null;r=[0,0,B.cos(r*C/180),B.sin(r*C/180)];var s=1/(F(q(r[2]),q(r[3]))||1);r[2]*=s;r[3]*=s;if(r[2]<
0){r[0]=-r[2];r[2]=0}if(r[3]<0){r[1]=-r[3];r[3]=0}}c=cb(c);if(!c)return null;s=a.getAttribute("fill");(s=s.match(/^url\(#(.*)\)$/))&&d.defs.removeChild(m.getElementById(s[1]));s=ba(f+"Gradient");s.id=Q();ba(s,f=="radial"?{fx:i,fy:e}:{x1:r[0],y1:r[1],x2:r[2],y2:r[3]});d.defs.appendChild(s);d=0;for(r=c[o];d<r;d++){var u=ba("stop");ba(u,{offset:c[d].offset?c[d].offset:d?"100%":"0%","stop-color":c[d].color||"#fff"});s.appendChild(u)}ba(a,{fill:"url(#"+s.id+")",opacity:1,"fill-opacity":1});l.fill="";l.opacity=
1;return l.fillOpacity=1},Sa=function(a){var c=a.getBBox();ba(a.pattern,{patternTransform:n.format("translate({0},{1})",c.x,c.y)})},xa=function(a,c){var d={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},f=a.node,i=a.attrs,e=a.rotate(),l=function(ca,U){if(U=d[x.call(U)]){for(var O=ca.attrs["stroke-width"]||"1",Y={round:O,square:O,butt:0}[ca.attrs["stroke-linecap"]||c["stroke-linecap"]]||0,
ja=[],oa=U[o];oa--;)ja[oa]=U[oa]*O+(oa%2?1:-1)*Y;ba(f,{"stroke-dasharray":ja[A](",")})}};c[h]("rotation")&&(e=c.rotation);var r=z(e).split(E);if(r.length-1){r[1]=+r[1];r[2]=+r[2]}else r=null;X(e)&&a.rotate(0,true);for(var s in c)if(c[h](s))if(Ea[h](s)){var u=c[s];i[s]=u;switch(s){case "blur":a.blur(u);break;case "rotation":a.rotate(u,true);break;case "href":case "title":case "target":var I=f.parentNode;if(x.call(I.tagName)!="a"){var K=ba("a");I.insertBefore(K,f);K.appendChild(f);I=K}s=="target"&&
u=="blank"?I.setAttributeNS(a.paper.xlink,"show","new"):I.setAttributeNS(a.paper.xlink,s,u);break;case "cursor":f.style.cursor=u;break;case "clip-rect":I=z(u).split(E);if(I[o]==4){a.clip&&a.clip.parentNode.parentNode.removeChild(a.clip.parentNode);var L=ba("clipPath");K=ba("rect");L.id=Q();ba(K,{x:I[0],y:I[1],width:I[2],height:I[3]});L.appendChild(K);a.paper.defs.appendChild(L);ba(f,{"clip-path":"url(#"+L.id+")"});a.clip=K}if(!u){(u=m.getElementById(f.getAttribute("clip-path").replace(/(^url\(#|\)$)/g,
"")))&&u.parentNode.removeChild(u);ba(f,{"clip-path":""});delete a.clip}break;case "path":a.type=="path"&&ba(f,{d:u?i.path=Aa(u):"M0,0"});break;case "width":f.setAttribute(s,u);if(i.fx){s="x";u=i.x}else break;case "x":i.fx&&(u=-i.x-(i.width||0));case "rx":if(s=="rx"&&a.type=="rect")break;case "cx":r&&(s=="x"||s=="cx")&&(r[1]+=u-i[s]);f.setAttribute(s,u);a.pattern&&Sa(a);break;case "height":f.setAttribute(s,u);if(i.fy){s="y";u=i.y}else break;case "y":i.fy&&(u=-i.y-(i.height||0));case "ry":if(s=="ry"&&
a.type=="rect")break;case "cy":r&&(s=="y"||s=="cy")&&(r[2]+=u-i[s]);f.setAttribute(s,u);a.pattern&&Sa(a);break;case "r":a.type=="rect"?ba(f,{rx:u,ry:u}):f.setAttribute(s,u);break;case "src":a.type=="image"&&f.setAttributeNS(a.paper.xlink,"href",u);break;case "stroke-width":f.style.strokeWidth=u;f.setAttribute(s,u);i["stroke-dasharray"]&&l(a,i["stroke-dasharray"]);break;case "stroke-dasharray":l(a,u);break;case "translation":u=z(u).split(E);u[0]=+u[0]||0;u[1]=+u[1]||0;if(r){r[1]+=u[0];r[2]+=u[1]}Ka.call(a,
u[0],u[1]);break;case "scale":u=z(u).split(E);a.scale(+u[0]||1,+u[1]||+u[0]||1,isNaN(X(u[2]))?null:+u[2],isNaN(X(u[3]))?null:+u[3]);break;case "fill":if(I=z(u).match(da)){L=ba("pattern");var R=ba("image");L.id=Q();ba(L,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});ba(R,{x:0,y:0});R.setAttributeNS(a.paper.xlink,"href",I[1]);L.appendChild(R);u=m.createElement("img");u.style.cssText="position:absolute;left:-9999em;top-9999em";u.onload=function(){ba(L,{width:this.offsetWidth,height:this.offsetHeight});
ba(R,{width:this.offsetWidth,height:this.offsetHeight});m.body.removeChild(this);a.paper.safari()};m.body.appendChild(u);u.src=I[1];a.paper.defs.appendChild(L);f.style.fill="url(#"+L.id+")";ba(f,{fill:"url(#"+L.id+")"});a.pattern=L;a.pattern&&Sa(a);break}I=n.getRGB(u);if(I.error)if(({circle:1,ellipse:1}[h](a.type)||z(u).charAt()!="r")&&Ba(f,u,a.paper)){i.gradient=u;i.fill="none";break}else{delete c.gradient;delete i.gradient;!n.is(i.opacity,"undefined")&&n.is(c.opacity,"undefined")&&ba(f,{opacity:i.opacity});
!n.is(i["fill-opacity"],"undefined")&&n.is(c["fill-opacity"],"undefined")&&ba(f,{"fill-opacity":i["fill-opacity"]})}I[h]("opacity")&&ba(f,{"fill-opacity":I.opacity>1?I.opacity/100:I.opacity});case "stroke":I=n.getRGB(u);f.setAttribute(s,I.hex);s=="stroke"&&I[h]("opacity")&&ba(f,{"stroke-opacity":I.opacity>1?I.opacity/100:I.opacity});break;case "gradient":(({circle:1,ellipse:1})[h](a.type)||z(u).charAt()!="r")&&Ba(f,u,a.paper);break;case "opacity":i.gradient&&!i[h]("stroke-opacity")&&ba(f,{"stroke-opacity":u>
1?u/100:u});case "fill-opacity":if(i.gradient){if(I=m.getElementById(f.getAttribute("fill").replace(/^url\(#|\)$/g,""))){I=I.getElementsByTagName("stop");I[I[o]-1].setAttribute("stop-opacity",u)}break}default:s=="font-size"&&(u=na(u,10)+"px");I=s.replace(/(\-.)/g,function(ca){return wa.call(ca.substring(1))});f.style[I]=u;f.setAttribute(s,u)}}Db(a,c);r?a.rotate(r.join(T)):X(e)&&a.rotate(e,true)},Db=function(a,c){if(!(a.type!="text"||!(c[h]("text")||c[h]("font")||c[h]("font-size")||c[h]("x")||c[h]("y")))){var d=
a.attrs,f=a.node,i=f.firstChild?na(m.defaultView.getComputedStyle(f.firstChild,"").getPropertyValue("font-size"),10):10;if(c[h]("text")){for(d.text=c.text;f.firstChild;)f.removeChild(f.firstChild);for(var e=z(c.text).split("\n"),l=0,r=e[o];l<r;l++)if(e[l]){var s=ba("tspan");l&&ba(s,{dy:i*1.2,x:d.x});s.appendChild(m.createTextNode(e[l]));f.appendChild(s)}}else{e=f.getElementsByTagName("tspan");l=0;for(r=e[o];l<r;l++)l&&ba(e[l],{dy:i*1.2,x:d.x})}ba(f,{y:d.y});i=a.getBBox();(i=d.y-(i.y+i.height/2))&&
n.is(i,"finite")&&ba(f,{y:d.y+i})}},ia=function(a,c){this[0]=a;this.id=n._oid++;this.node=a;a.raphael=this;this.paper=c;this.attrs=this.attrs||{};this.transformations=[];this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1};!c.bottom&&(c.bottom=this);(this.prev=c.top)&&(c.top.next=this);c.top=this;this.next=null},ga=ia[G];ia[G].rotate=function(a,c,d){if(this.removed)return this;if(a==null){if(this._.rt.cx)return[this._.rt.deg,this._.rt.cx,this._.rt.cy][A](T);return this._.rt.deg}var f=this.getBBox();
a=z(a).split(E);if(a[o]-1){c=X(a[1]);d=X(a[2])}a=X(a[0]);c!=null&&c!==false?this._.rt.deg=a:this._.rt.deg+=a;d==null&&(c=null);this._.rt.cx=c;this._.rt.cy=d;c=c==null?f.x+f.width/2:c;d=d==null?f.y+f.height/2:d;if(this._.rt.deg){this.transformations[0]=n.format("rotate({0} {1} {2})",this._.rt.deg,c,d);this.clip&&ba(this.clip,{transform:n.format("rotate({0} {1} {2})",-this._.rt.deg,c,d)})}else{this.transformations[0]="";this.clip&&ba(this.clip,{transform:""})}ba(this.node,{transform:this.transformations[A](T)});
return this};ia[G].hide=function(){!this.removed&&(this.node.style.display="none");return this};ia[G].show=function(){!this.removed&&(this.node.style.display="");return this};ia[G].remove=function(){if(!this.removed){za(this,this.paper);this.node.parentNode.removeChild(this.node);for(var a in this)delete this[a];this.removed=true}};ia[G].getBBox=function(){if(this.removed)return this;if(this.type=="path")return Ia(this.attrs.path);if(this.node.style.display=="none"){this.show();var a=true}var c={};
try{c=this.node.getBBox()}catch(d){}finally{c=c||{}}if(this.type=="text"){c={x:c.x,y:Infinity,width:0,height:0};for(var f=0,i=this.node.getNumberOfChars();f<i;f++){var e=this.node.getExtentOfChar(f);e.y<c.y&&(c.y=e.y);e.y+e.height-c.y>c.height&&(c.height=e.y+e.height-c.y);e.x+e.width-c.x>c.width&&(c.width=e.x+e.width-c.x)}}a&&this.hide();return c};ia[G].attr=function(a,c){if(this.removed)return this;if(a==null){var d={},f;for(f in this.attrs)this.attrs[h](f)&&(d[f]=this.attrs[f]);this._.rt.deg&&(d.rotation=
this.rotate());(this._.sx!=1||this._.sy!=1)&&(d.scale=this.scale());d.gradient&&d.fill=="none"&&(d.fill=d.gradient)&&delete d.gradient;return d}if(c==null&&n.is(a,"string")){if(a=="translation")return Ka.call(this);if(a=="rotation")return this.rotate();if(a=="scale")return this.scale();if(a=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;return this.attrs[a]}if(c==null&&n.is(a,P)){f={};d=0;for(var i=a.length;d<i;d++)f[a[d]]=this.attr(a[d]);return f}if(c!=null){d={};
d[a]=c}else a!=null&&n.is(a,"object")&&(d=a);for(i in this.paper.customAttributes)if(this.paper.customAttributes[h](i)&&d[h](i)&&n.is(this.paper.customAttributes[i],"function")){f=this.paper.customAttributes[i].apply(this,[].concat(d[i]));this.attrs[i]=d[i];for(var e in f)f[h](e)&&(d[e]=f[e])}xa(this,d);return this};ia[G].toFront=function(){if(this.removed)return this;this.node.parentNode.appendChild(this.node);var a=this.paper;a.top!=this&&eb(this,a);return this};ia[G].toBack=function(){if(this.removed)return this;
if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);fb(this,this.paper)}return this};ia[G].insertAfter=function(a){if(this.removed)return this;var c=a.node||a[a.length-1].node;c.nextSibling?c.parentNode.insertBefore(this.node,c.nextSibling):c.parentNode.appendChild(this.node);gb(this,a,this.paper);return this};ia[G].insertBefore=function(a){if(this.removed)return this;var c=a.node||a[0].node;c.parentNode.insertBefore(this.node,
c);hb(this,a,this.paper);return this};ia[G].blur=function(a){if(+a!==0){var c=ba("filter"),d=ba("feGaussianBlur");this.attrs.blur=a;c.id=Q();ba(d,{stdDeviation:+a||1.5});c.appendChild(d);this.paper.defs.appendChild(c);this._blur=c;ba(this.node,{filter:"url(#"+c.id+")"})}else{if(this._blur){this._blur.parentNode.removeChild(this._blur);delete this._blur;delete this.attrs.blur}this.node.removeAttribute("filter")}};var kb=function(a,c,d,f){var i=ba("circle");a.canvas&&a.canvas.appendChild(i);a=new ia(i,
a);a.attrs={cx:c,cy:d,r:f,fill:"none",stroke:"#000"};a.type="circle";ba(i,a.attrs);return a},lb=function(a,c,d,f,i,e){var l=ba("rect");a.canvas&&a.canvas.appendChild(l);a=new ia(l,a);a.attrs={x:c,y:d,width:f,height:i,r:e||0,rx:e||0,ry:e||0,fill:"none",stroke:"#000"};a.type="rect";ba(l,a.attrs);return a},mb=function(a,c,d,f,i){var e=ba("ellipse");a.canvas&&a.canvas.appendChild(e);a=new ia(e,a);a.attrs={cx:c,cy:d,rx:f,ry:i,fill:"none",stroke:"#000"};a.type="ellipse";ba(e,a.attrs);return a},nb=function(a,
c,d,f,i,e){var l=ba("image");ba(l,{x:d,y:f,width:i,height:e,preserveAspectRatio:"none"});l.setAttributeNS(a.xlink,"href",c);a.canvas&&a.canvas.appendChild(l);a=new ia(l,a);a.attrs={x:d,y:f,width:i,height:e,src:c};a.type="image";return a},ob=function(a,c,d,f){var i=ba("text");ba(i,{x:c,y:d,"text-anchor":"middle"});a.canvas&&a.canvas.appendChild(i);a=new ia(i,a);a.attrs={x:c,y:d,"text-anchor":"middle",text:f,font:Ea.font,stroke:"none",fill:"#000"};a.type="text";xa(a,a.attrs);return a},pb=function(a,
c){this.width=a||this.width;this.height=c||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);return this},Na=function(){var a=db[H](0,arguments),c=a&&a.container,d=a.x,f=a.y,i=a.width;a=a.height;if(!c)throw Error("SVG container not found.");var e=ba("svg");d=d||0;f=f||0;i=i||512;a=a||342;ba(e,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:i,height:a});if(c==1){e.style.cssText="position:absolute;left:"+d+"px;top:"+f+"px";m.body.appendChild(e)}else c.firstChild?
c.insertBefore(e,c.firstChild):c.appendChild(e);c=new k;c.width=i;c.height=a;c.canvas=e;Ra.call(c,c,n.fn);c.clear();return c};D.clear=function(){for(var a=this.canvas;a.firstChild;)a.removeChild(a.firstChild);this.bottom=this.top=null;(this.desc=ba("desc")).appendChild(m.createTextNode("Created with Rapha\u00ebl"));a.appendChild(this.desc);a.appendChild(this.defs=ba("defs"))};D.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=ib(a)}}if(n.vml){var qb=
{M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Eb=/([clmz]),?([^clmz]*)/gi,Fb=/ progid:\S+Blur\([^\)]+\)/g,Gb=/-?[^,\s-]+/g,Ca=1E3+T+1E3,Da={path:1,rect:1},Hb=function(a){var c=/[ahqstv]/ig,d=Aa;z(a).match(c)&&(d=Ha);c=/[clmz]/g;if(d==Aa&&!z(a).match(c))return a=z(a).replace(Eb,function(s,u,I){var K=[],L=x.call(u)=="m",R=qb[u];I.replace(Gb,function(ca){if(L&&K[o]==2){R+=K+qb[u=="m"?"l":"L"];K=[]}K[$](aa(ca*10))});return R+K});c=d(a);var f;a=[];for(var i=0,e=c[o];i<e;i++){d=c[i];f=x.call(c[i][0]);
f=="z"&&(f="x");for(var l=1,r=d[o];l<r;l++)f+=aa(d[l]*10)+(l!=r-1?",":"");a[$](f)}return a[A](T)};n[Z]=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\u00ebl "+this.version};jb=function(a,c){var d=qa("group");d.style.cssText="position:absolute;left:0;top:0;width:"+c.width+"px;height:"+c.height+"px";d.coordsize=c.coordsize;d.coordorigin=c.coordorigin;var f=qa("shape"),i=f.style;i.width=c.width+"px";i.height=c.height+"px";f.coordsize=Ca;f.coordorigin=
c.coordorigin;d.appendChild(f);f=new ia(f,d,c);i={fill:"none",stroke:"#000"};a&&(i.path=a);f.type="path";f.path=[];f.Path="";xa(f,i);c.canvas.appendChild(d);return f};xa=function(a,c){a.attrs=a.attrs||{};var d=a.node,f=a.attrs,i=d.style,e;e=(c.x!=f.x||c.y!=f.y||c.width!=f.width||c.height!=f.height||c.r!=f.r)&&a.type=="rect";for(var l in c)c[h](l)&&(f[l]=c[l]);if(e){f.path=rb(f.x,f.y,f.width,f.height,f.r);a.X=f.x;a.Y=f.y;a.W=f.width;a.H=f.height}c.href&&(d.href=c.href);c.title&&(d.title=c.title);c.target&&
(d.target=c.target);c.cursor&&(i.cursor=c.cursor);"blur"in c&&a.blur(c.blur);if(c.path&&a.type=="path"||e)d.path=Hb(f.path);c.rotation!=null&&a.rotate(c.rotation,true);if(c.translation){e=z(c.translation).split(E);Ka.call(a,e[0],e[1]);if(a._.rt.cx!=null){a._.rt.cx+=+e[0];a._.rt.cy+=+e[1];a.setBox(a.attrs,e[0],e[1])}}if(c.scale){e=z(c.scale).split(E);a.scale(+e[0]||1,+e[1]||+e[0]||1,+e[2]||null,+e[3]||null)}if("clip-rect"in c){e=z(c["clip-rect"]).split(E);if(e[o]==4){e[2]=+e[2]+ +e[0];e[3]=+e[3]+ +e[1];
l=d.clipRect||m.createElement("div");var r=l.style,s=d.parentNode;r.clip=n.format("rect({1}px {2}px {3}px {0}px)",e);if(!d.clipRect){r.position="absolute";r.top=0;r.left=0;r.width=a.paper.width+"px";r.height=a.paper.height+"px";s.parentNode.insertBefore(l,s);l.appendChild(s);d.clipRect=l}}c["clip-rect"]||d.clipRect&&(d.clipRect.style.clip="")}a.type=="image"&&c.src&&(d.src=c.src);if(a.type=="image"&&c.opacity){d.filterOpacity=" progid:DXImageTransform.Microsoft.Alpha(opacity="+c.opacity*100+")";i.filter=
(d.filterMatrix||"")+(d.filterOpacity||"")}c.font&&(i.font=c.font);c["font-family"]&&(i.fontFamily='"'+c["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,"")+'"');c["font-size"]&&(i.fontSize=c["font-size"]);c["font-weight"]&&(i.fontWeight=c["font-weight"]);c["font-style"]&&(i.fontStyle=c["font-style"]);if(c.opacity!=null||c["stroke-width"]!=null||c.fill!=null||c.stroke!=null||c["stroke-width"]!=null||c["stroke-opacity"]!=null||c["fill-opacity"]!=null||c["stroke-dasharray"]!=null||c["stroke-miterlimit"]!=
null||c["stroke-linejoin"]!=null||c["stroke-linecap"]!=null){d=a.shape||d;e=d.getElementsByTagName("fill")&&d.getElementsByTagName("fill")[0];l=false;!e&&(l=e=qa("fill"));if("fill-opacity"in c||"opacity"in c){i=((+f["fill-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+n.getRGB(c.fill).o+1||2)-1);i=j(F(i,0),1);e.opacity=i}c.fill&&(e.on=true);if(e.on==null||c.fill=="none")e.on=false;if(e.on&&c.fill)if(i=c.fill.match(da)){e.src=i[1];e.type="tile"}else{e.color=n.getRGB(c.fill).hex;e.src="";e.type="solid";
if(n.getRGB(c.fill).error&&(a.type in{circle:1,ellipse:1}||z(c.fill).charAt()!="r")&&Ba(a,c.fill)){f.fill="none";f.gradient=c.fill}}l&&d.appendChild(e);e=d.getElementsByTagName("stroke")&&d.getElementsByTagName("stroke")[0];l=false;!e&&(l=e=qa("stroke"));if(c.stroke&&c.stroke!="none"||c["stroke-width"]||c["stroke-opacity"]!=null||c["stroke-dasharray"]||c["stroke-miterlimit"]||c["stroke-linejoin"]||c["stroke-linecap"])e.on=true;(c.stroke=="none"||e.on==null||c.stroke==0||c["stroke-width"]==0)&&(e.on=
false);i=n.getRGB(c.stroke);e.on&&c.stroke&&(e.color=i.hex);i=((+f["stroke-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+i.o+1||2)-1);r=(X(c["stroke-width"])||1)*0.75;i=j(F(i,0),1);c["stroke-width"]==null&&(r=f["stroke-width"]);c["stroke-width"]&&(e.weight=r);r&&r<1&&(i*=r)&&(e.weight=1);e.opacity=i;c["stroke-linejoin"]&&(e.joinstyle=c["stroke-linejoin"]||"miter");e.miterlimit=c["stroke-miterlimit"]||8;c["stroke-linecap"]&&(e.endcap=c["stroke-linecap"]=="butt"?"flat":c["stroke-linecap"]=="square"?"square":
"round");if(c["stroke-dasharray"]){i={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};e.dashstyle=i[h](c["stroke-dasharray"])?i[c["stroke-dasharray"]]:""}l&&d.appendChild(e)}if(a.type=="text"){i=a.paper.span.style;f.font&&(i.font=f.font);f["font-family"]&&(i.fontFamily=f["font-family"]);f["font-size"]&&(i.fontSize=f["font-size"]);f["font-weight"]&&(i.fontWeight=f["font-weight"]);
f["font-style"]&&(i.fontStyle=f["font-style"]);a.node.string&&(a.paper.span.innerHTML=z(a.node.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));a.W=f.w=a.paper.span.offsetWidth;a.H=f.h=a.paper.span.offsetHeight;a.X=f.x;a.Y=f.y+aa(a.H/2);switch(f["text-anchor"]){case "start":a.node.style["v-text-align"]="left";a.bbx=aa(a.W/2);break;case "end":a.node.style["v-text-align"]="right";a.bbx=-aa(a.W/2);break;default:a.node.style["v-text-align"]="center"}}};Ba=function(a,c){a.attrs=
a.attrs||{};var d,f="linear",i=".5 .5";a.attrs.gradient=c;c=z(c).replace(Za,function(I,K,L){f="radial";if(K&&L){K=X(K);L=X(L);y(K-0.5,2)+y(L-0.5,2)>0.25&&(L=B.sqrt(0.25-y(K-0.5,2))*((L>0.5)*2-1)+0.5);i=K+T+L}return""});c=c.split(/\s*\-\s*/);if(f=="linear"){var e=c.shift();e=-X(e);if(isNaN(e))return null}var l=cb(c);if(!l)return null;a=a.shape||a.node;d=a.getElementsByTagName("fill")[0]||qa("fill");!d.parentNode&&a.appendChild(d);if(l[o]){d.on=true;d.method="none";d.color=l[0].color;d.color2=l[l[o]-
1].color;for(var r=[],s=0,u=l[o];s<u;s++)l[s].offset&&r[$](l[s].offset+T+l[s].color);d.colors&&(d.colors.value=r[o]?r[A]():"0% "+d.color);if(f=="radial"){d.type="gradientradial";d.focus="100%";d.focussize=i;d.focusposition=i}else{d.type="gradient";d.angle=(270-e)%360}}return 1};ia=function(a,c,d){this[0]=a;this.id=n._oid++;this.node=a;a.raphael=this;this.Y=this.X=0;this.attrs={};this.Group=c;this.paper=d;this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1};!d.bottom&&(d.bottom=this);(this.prev=d.top)&&(d.top.next=
this);d.top=this;this.next=null};ga=ia[G];ga.rotate=function(a,c,d){if(this.removed)return this;if(a==null){if(this._.rt.cx)return[this._.rt.deg,this._.rt.cx,this._.rt.cy][A](T);return this._.rt.deg}a=z(a).split(E);if(a[o]-1){c=X(a[1]);d=X(a[2])}a=X(a[0]);c!=null?this._.rt.deg=a:this._.rt.deg+=a;d==null&&(c=null);this._.rt.cx=c;this._.rt.cy=d;this.setBox(this.attrs,c,d);this.Group.style.rotation=this._.rt.deg;return this};ga.setBox=function(a,c,d){if(this.removed)return this;var f=this.Group.style,
i=this.shape&&this.shape.style||this.node.style;a=a||{};for(var e in a)a[h](e)&&(this.attrs[e]=a[e]);c=c||this._.rt.cx;d=d||this._.rt.cy;var l=this.attrs,r;switch(this.type){case "circle":a=l.cx-l.r;e=l.cy-l.r;r=l=l.r*2;break;case "ellipse":a=l.cx-l.rx;e=l.cy-l.ry;r=l.rx*2;l=l.ry*2;break;case "image":a=+l.x;e=+l.y;r=l.width||0;l=l.height||0;break;case "text":this.textpath.v=["m",aa(l.x),", ",aa(l.y-2),"l",aa(l.x)+1,", ",aa(l.y-2)][A]("");a=l.x-aa(this.W/2);e=l.y-this.H/2;r=this.W;l=this.H;break;case "rect":case "path":if(this.attrs.path){l=
Ia(this.attrs.path);a=l.x;e=l.y;r=l.width;l=l.height}else{e=a=0;r=this.paper.width;l=this.paper.height}break;default:e=a=0;r=this.paper.width;l=this.paper.height}c=(c==null?a+r/2:c)-this.paper.width/2;d=(d==null?e+l/2:d)-this.paper.height/2;var s;f.left!=(s=c+"px")&&(f.left=s);f.top!=(s=d+"px")&&(f.top=s);this.X=Da[h](this.type)?-c:a;this.Y=Da[h](this.type)?-d:e;this.W=r;this.H=l;if(Da[h](this.type)){i.left!=(s=-c*10+"px")&&(i.left=s);i.top!=(s=-d*10+"px")&&(i.top=s)}else if(this.type=="text"){i.left!=
(s=-c+"px")&&(i.left=s);i.top!=(s=-d+"px")&&(i.top=s)}else{f.width!=(s=this.paper.width+"px")&&(f.width=s);f.height!=(s=this.paper.height+"px")&&(f.height=s);i.left!=(s=a-c+"px")&&(i.left=s);i.top!=(s=e-d+"px")&&(i.top=s);i.width!=(s=r+"px")&&(i.width=s);i.height!=(s=l+"px")&&(i.height=s)}};ga.hide=function(){!this.removed&&(this.Group.style.display="none");return this};ga.show=function(){!this.removed&&(this.Group.style.display="block");return this};ga.getBBox=function(){if(this.removed)return this;
if(Da[h](this.type))return Ia(this.attrs.path);return{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}};ga.remove=function(){if(!this.removed){za(this,this.paper);this.node.parentNode.removeChild(this.node);this.Group.parentNode.removeChild(this.Group);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this)delete this[a];this.removed=true}};ga.attr=function(a,c){if(this.removed)return this;if(a==null){var d={},f;for(f in this.attrs)this.attrs[h](f)&&(d[f]=this.attrs[f]);
this._.rt.deg&&(d.rotation=this.rotate());(this._.sx!=1||this._.sy!=1)&&(d.scale=this.scale());d.gradient&&d.fill=="none"&&(d.fill=d.gradient)&&delete d.gradient;return d}if(c==null&&n.is(a,"string")){if(a=="translation")return Ka.call(this);if(a=="rotation")return this.rotate();if(a=="scale")return this.scale();if(a=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;return this.attrs[a]}if(this.attrs&&c==null&&n.is(a,P)){var i={};f=0;for(d=a[o];f<d;f++)i[a[f]]=this.attr(a[f]);
return i}if(c!=null){d={};d[a]=c}c==null&&n.is(a,"object")&&(d=a);if(d){for(i in this.paper.customAttributes)if(this.paper.customAttributes[h](i)&&d[h](i)&&n.is(this.paper.customAttributes[i],"function")){f=this.paper.customAttributes[i].apply(this,[].concat(d[i]));this.attrs[i]=d[i];for(var e in f)f[h](e)&&(d[e]=f[e])}d.text&&this.type=="text"&&(this.node.string=d.text);xa(this,d);d.gradient&&({circle:1,ellipse:1}[h](this.type)||z(d.gradient).charAt()!="r")&&Ba(this,d.gradient);(!Da[h](this.type)||
this._.rt.deg)&&this.setBox(this.attrs)}return this};ga.toFront=function(){!this.removed&&this.Group.parentNode.appendChild(this.Group);this.paper.top!=this&&eb(this,this.paper);return this};ga.toBack=function(){if(this.removed)return this;if(this.Group.parentNode.firstChild!=this.Group){this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild);fb(this,this.paper)}return this};ga.insertAfter=function(a){if(this.removed)return this;a.constructor==sa&&(a=a[a.length-1]);a.Group.nextSibling?
a.Group.parentNode.insertBefore(this.Group,a.Group.nextSibling):a.Group.parentNode.appendChild(this.Group);gb(this,a,this.paper);return this};ga.insertBefore=function(a){if(this.removed)return this;a.constructor==sa&&(a=a[0]);a.Group.parentNode.insertBefore(this.Group,a.Group);hb(this,a,this.paper);return this};ga.blur=function(a){var c=this.node.runtimeStyle,d=c.filter;d=d.replace(Fb,"");if(+a!==0){this.attrs.blur=a;c.filter=d+T+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+a||1.5)+")";
c.margin=n.format("-{0}px 0 0 -{0}px",aa(+a||1.5))}else{c.filter=d;c.margin=0;delete this.attrs.blur}};kb=function(a,c,d,f){var i=qa("group"),e=qa("oval");i.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";i.coordsize=Ca;i.coordorigin=a.coordorigin;i.appendChild(e);e=new ia(e,i,a);e.type="circle";xa(e,{stroke:"#000",fill:"none"});e.attrs.cx=c;e.attrs.cy=d;e.attrs.r=f;e.setBox({x:c-f,y:d-f,width:f*2,height:f*2});a.canvas.appendChild(i);return e};var rb=function(a,
c,d,f,i){return i?n.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",a+i,c,d-i*2,i,-i,f-i*2,i*2-d,i*2-f):n.format("M{0},{1}l{2},0,0,{3},{4},0z",a,c,d,f,-d)};lb=function(a,c,d,f,i,e){var l=rb(c,d,f,i,e);a=a.path(l);var r=a.attrs;a.X=r.x=c;a.Y=r.y=d;a.W=r.width=f;a.H=r.height=i;r.r=e;r.path=l;a.type="rect";return a};mb=function(a,c,d,f,i){var e=qa("group"),l=qa("oval");e.style.cssText="position:absolute;left:0;top:0;width:"+
a.width+"px;height:"+a.height+"px";e.coordsize=Ca;e.coordorigin=a.coordorigin;e.appendChild(l);l=new ia(l,e,a);l.type="ellipse";xa(l,{stroke:"#000"});l.attrs.cx=c;l.attrs.cy=d;l.attrs.rx=f;l.attrs.ry=i;l.setBox({x:c-f,y:d-i,width:f*2,height:i*2});a.canvas.appendChild(e);return l};nb=function(a,c,d,f,i,e){var l=qa("group"),r=qa("image");l.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";l.coordsize=Ca;l.coordorigin=a.coordorigin;r.src=c;l.appendChild(r);r=new ia(r,
l,a);r.type="image";r.attrs.src=c;r.attrs.x=d;r.attrs.y=f;r.attrs.w=i;r.attrs.h=e;r.setBox({x:d,y:f,width:i,height:e});a.canvas.appendChild(l);return r};ob=function(a,c,d,f){var i=qa("group"),e=qa("shape"),l=e.style,r=qa("path"),s=qa("textpath");i.style.cssText="position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px";i.coordsize=Ca;i.coordorigin=a.coordorigin;r.v=n.format("m{0},{1}l{2},{1}",aa(c*10),aa(d*10),aa(c*10)+1);r.textpathok=true;l.width=a.width;l.height=a.height;s.string=
z(f);s.on=true;e.appendChild(s);e.appendChild(r);i.appendChild(e);l=new ia(s,i,a);l.shape=e;l.textpath=r;l.type="text";l.attrs.text=f;l.attrs.x=c;l.attrs.y=d;l.attrs.w=1;l.attrs.h=1;xa(l,{font:Ea.font,stroke:"none",fill:"#000"});l.setBox();a.canvas.appendChild(i);return l};pb=function(a,c){var d=this.canvas.style;a==+a&&(a+="px");c==+c&&(c+="px");d.width=a;d.height=c;d.clip="rect(0 "+a+" "+c+" 0)";return this};var qa;m.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!m.namespaces.rvml&&
m.namespaces.add("rvml","urn:schemas-microsoft-com:vml");qa=function(a){return m.createElement("<rvml:"+a+' class="rvml">')}}catch(Ob){qa=function(a){return m.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}Na=function(){var a=db[H](0,arguments),c=a.container,d=a.height,f=a.width,i=a.x;a=a.y;if(!c)throw Error("VML container not found.");var e=new k,l=e.canvas=m.createElement("div"),r=l.style;i=i||0;a=a||0;f=f||512;d=d||342;f==+f&&(f+="px");d==+d&&(d+="px");e.width=1E3;
e.height=1E3;e.coordsize=1E4+T+1E4;e.coordorigin="0 0";e.span=m.createElement("span");e.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";l.appendChild(e.span);r.cssText=n.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",f,d);if(c==1){m.body.appendChild(l);r.left=i+"px";r.top=a+"px";r.position="absolute"}else c.firstChild?c.insertBefore(l,c.firstChild):c.appendChild(l);
Ra.call(e,e,n.fn);return e};D.clear=function(){this.canvas.innerHTML="";this.span=m.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};D.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var a in this)this[a]=ib(a);return true}}ta=navigator.userAgent.match(/Version\\x2f(.*?)\s/);navigator.vendor=="Apple Computer, Inc."&&(ta&&ta[1]<
4||navigator.platform.slice(0,2)=="iP")?D.safari=function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});v.setTimeout(function(){a.remove()})}:D.safari=function(){};var Ib=function(){this.returnValue=false},Jb=function(){return this.originalEvent.preventDefault()},Kb=function(){this.cancelBubble=true},Lb=function(){return this.originalEvent.stopPropagation()},Mb=function(){if(m.addEventListener)return function(a,c,d,f){var i=W&&ha[c]?ha[c]:c,e=function(l){if(W&&ha[h](c))for(var r=
0,s=l.targetTouches&&l.targetTouches.length;r<s;r++)if(l.targetTouches[r].target==a){s=l;l=l.targetTouches[r];l.originalEvent=s;l.preventDefault=Jb;l.stopPropagation=Lb;break}return d.call(f,l)};a.addEventListener(i,e,false);return function(){a.removeEventListener(i,e,false);return true}};if(m.attachEvent)return function(a,c,d,f){var i=function(e){e=e||v.event;e.preventDefault=e.preventDefault||Ib;e.stopPropagation=e.stopPropagation||Kb;return d.call(f,e)};a.attachEvent("on"+c,i);return function(){a.detachEvent("on"+
c,i);return true}}}(),ua=[],Ta=function(a){for(var c=a.clientX,d=a.clientY,f=m.documentElement.scrollTop||m.body.scrollTop,i=m.documentElement.scrollLeft||m.body.scrollLeft,e,l=ua.length;l--;){e=ua[l];if(W)for(var r=a.touches.length,s;r--;){s=a.touches[r];if(s.identifier==e.el._drag.id){c=s.clientX;d=s.clientY;(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();c+=i;d+=f;e.move&&e.move.call(e.move_scope||e.el,c-e.el._drag.x,d-e.el._drag.y,c,d,a)}},Ua=function(a){n.unmousemove(Ta).unmouseup(Ua);
for(var c=ua.length,d;c--;){d=ua[c];d.el._drag={};d.end&&d.end.call(d.end_scope||d.start_scope||d.move_scope||d.el,a)}ua=[]};for(ta=ea[o];ta--;)(function(a){n[a]=ia[G][a]=function(c,d){if(n.is(c,"function")){this.events=this.events||[];this.events.push({name:a,f:c,unbind:Mb(this.shape||this.node||m,a,c,d||this)})}return this};n["un"+a]=ia[G]["un"+a]=function(c){for(var d=this.events,f=d[o];f--;)if(d[f].name==a&&d[f].f==c){d[f].unbind();d.splice(f,1);!d.length&&delete this.events;break}return this}})(ea[ta]);
ga.hover=function(a,c,d,f){return this.mouseover(a,d).mouseout(c,f||d)};ga.unhover=function(a,c){return this.unmouseover(a).unmouseout(c)};ga.drag=function(a,c,d,f,i,e){this._drag={};this.mousedown(function(l){(l.originalEvent||l).preventDefault();var r=m.documentElement.scrollTop||m.body.scrollTop,s=m.documentElement.scrollLeft||m.body.scrollLeft;this._drag.x=l.clientX+s;this._drag.y=l.clientY+r;this._drag.id=l.identifier;c&&c.call(i||f||this,l.clientX+s,l.clientY+r,l);!ua.length&&n.mousemove(Ta).mouseup(Ua);
ua.push({el:this,move:a,end:d,move_scope:f,start_scope:i,end_scope:e})});return this};ga.undrag=function(a,c,d){for(c=ua.length;c--;)ua[c].el==this&&ua[c].move==a&&ua[c].end==d&&ua.splice(c++,1);!ua.length&&n.unmousemove(Ta).unmouseup(Ua)};D.circle=function(a,c,d){return kb(this,a||0,c||0,d||0)};D.rect=function(a,c,d,f,i){return lb(this,a||0,c||0,d||0,f||0,i||0)};D.ellipse=function(a,c,d,f){return mb(this,a||0,c||0,d||0,f||0)};D.path=function(a){a&&!n.is(a,"string")&&!n.is(a[0],P)&&(a+="");return jb(n.format[H](n,
arguments),this)};D.image=function(a,c,d,f,i){return nb(this,a||"about:blank",c||0,d||0,f||0,i||0)};D.text=function(a,c,d){return ob(this,a||0,c||0,z(d))};D.set=function(a){arguments[o]>1&&(a=Array[G].splice.call(arguments,0,arguments[o]));return new sa(a)};D.setSize=pb;D.top=D.bottom=null;D.raphael=n;ga.resetScale=function(){if(this.removed)return this;this._.sx=1;this._.sy=1;this.attrs.scale="1 1"};ga.scale=function(a,c,d,f){if(this.removed)return this;if(a==null&&c==null)return{x:this._.sx,y:this._.sy,
toString:J};c=c||a;!+c&&(c=a);var i,e,l=this.attrs;if(a!=0){var r=this.getBBox(),s=r.x+r.width/2,u=r.y+r.height/2;i=q(a/this._.sx);e=q(c/this._.sy);d=+d||d==0?d:s;f=+f||f==0?f:u;var I=this._.sx>0,K=this._.sy>0;r=~~(a/q(a));var L=~~(c/q(c)),R=i*r,ca=e*L,U=this.node.style;s=d+q(s-d)*R*(s>d==I?1:-1);u=f+q(u-f)*ca*(u>f==K?1:-1);var O=a*r>c*L?e:i;switch(this.type){case "rect":case "image":var Y=l.width*i,ja=l.height*e;this.attr({height:ja,r:l.r*O,width:Y,x:s-Y/2,y:u-ja/2});break;case "circle":case "ellipse":this.attr({rx:l.rx*
i,ry:l.ry*e,r:l.r*O,cx:s,cy:u});break;case "text":this.attr({x:s,y:u});break;case "path":O=Qa(l.path);var oa=true;I=I?R:i;K=K?ca:e;ca=0;for(R=O[o];ca<R;ca++){var pa=O[ca],ma=wa.call(pa[0]);if(!(ma=="M"&&oa)){oa=false;if(ma=="A"){pa[O[ca][o]-2]*=I;pa[O[ca][o]-1]*=K;pa[1]*=i;pa[2]*=e;pa[5]=+(r+L?!!+pa[5]:!+pa[5])}else if(ma=="H"){ma=1;for(var ya=pa[o];ma<ya;ma++)pa[ma]*=I}else if(ma=="V"){ma=1;for(ya=pa[o];ma<ya;ma++)pa[ma]*=K}else{ma=1;for(ya=pa[o];ma<ya;ma++)pa[ma]*=ma%2?I:K}}}e=Ia(O);i=s-e.x-e.width/
2;e=u-e.y-e.height/2;O[0][1]+=i;O[0][2]+=e;this.attr({path:O})}if(this.type in{text:1,image:1}&&(r!=1||L!=1))if(this.transformations){this.transformations[2]="scale(".concat(r,",",L,")");this.node.setAttribute("transform",this.transformations[A](T));i=r==-1?-l.x-(Y||0):l.x;e=L==-1?-l.y-(ja||0):l.y;this.attr({x:i,y:e});l.fx=r-1;l.fy=L-1}else{this.node.filterMatrix=" progid:DXImageTransform.Microsoft"+".Matrix(M11=".concat(r,", M12=0, M21=0, M22=",L,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')");
U.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}else if(this.transformations){this.transformations[2]="";this.node.setAttribute("transform",this.transformations[A](T));l.fx=0;l.fy=0}else{this.node.filterMatrix="";U.filter=(this.node.filterMatrix||"")+(this.node.filterOpacity||"")}l.scale=[a,c,d,f][A](T);this._.sx=a;this._.sy=c}return this};ga.clone=function(){if(this.removed)return null;var a=this.attr();delete a.scale;delete a.translation;return this.paper[this.type]().attr(a)};
var Va={},La=function(a,c,d,f,i,e,l,r,s){var u=0,I=100,K=[a,c,d,f,i,e,l,r].join(),L=Va[K],R,ca;!L&&(Va[K]=L={data:[]});L.timer&&clearTimeout(L.timer);L.timer=setTimeout(function(){delete Va[K]},2E3);if(s!=null)I=~~La(a,c,d,f,i,e,l,r)*10;for(var U=0;U<I+1;U++){if(L.data[s]>U)ca=L.data[U*I];else{ca=n.findDotsAtSegment(a,c,d,f,i,e,l,r,U/I);L.data[U]=ca}U&&(u+=y(y(R.x-ca.x,2)+y(R.y-ca.y,2),0.5));if(s!=null&&u>=s)return ca;R=ca}if(s==null)return u};ea=function(a,c){return function(d,f,i){d=Ha(d);for(var e,
l,r,s,u="",I={},K=0,L=0,R=d.length;L<R;L++){r=d[L];if(r[0]=="M"){e=+r[1];l=+r[2]}else{s=La(e,l,r[1],r[2],r[3],r[4],r[5],r[6]);if(K+s>f){if(c&&!I.start){e=La(e,l,r[1],r[2],r[3],r[4],r[5],r[6],f-K);u+=["C",e.start.x,e.start.y,e.m.x,e.m.y,e.x,e.y];if(i)return u;I.start=u;u=["M",e.x,e.y+"C",e.n.x,e.n.y,e.end.x,e.end.y,r[5],r[6]][A]();K+=s;e=+r[5];l=+r[6];continue}if(!a&&!c){e=La(e,l,r[1],r[2],r[3],r[4],r[5],r[6],f-K);return{x:e.x,y:e.y,alpha:e.alpha}}}K+=s;e=+r[5];l=+r[6]}u+=r}I.end=u;e=a?K:c?I:n.findDotsAtSegment(e,
l,r[1],r[2],r[3],r[4],r[5],r[6],1);e.alpha&&(e={x:e.x,y:e.y,alpha:e.alpha});return e}};var sb=ea(1),Ma=ea(),Wa=ea(0,1);ga.getTotalLength=function(){if(this.type=="path"){if(this.node.getTotalLength)return this.node.getTotalLength();return sb(this.attrs.path)}};ga.getPointAtLength=function(a){if(this.type=="path")return Ma(this.attrs.path,a)};ga.getSubpath=function(a,c){if(this.type=="path"){if(q(this.getTotalLength()-c)<"1e-6")return Wa(this.attrs.path,a).end;var d=Wa(this.attrs.path,c,1);return a?
Wa(d,a).end:d}};n.easing_formulas={linear:function(a){return a},"<":function(a){return y(a,3)},">":function(a){return y(a-1,3)+1},"<>":function(a){a*=2;if(a<1)return y(a,3)/2;a-=2;return(y(a,3)+2)/2},backIn:function(a){return a*a*(2.70158*a-1.70158)},backOut:function(a){a-=1;return a*a*(2.70158*a+1.70158)+1},elastic:function(a){if(a==0||a==1)return a;return y(2,-10*a)*B.sin((a-0.075)*2*C/0.3)+1},bounce:function(a){if(a<1/2.75)a*=7.5625*a;else if(a<2/2.75){a-=1.5/2.75;a=7.5625*a*a+0.75}else if(a<2.5/
2.75){a-=2.25/2.75;a=7.5625*a*a+0.9375}else{a-=2.625/2.75;a=7.5625*a*a+0.984375}return a}};var va=[],tb=function(){for(var a=+new Date,c=0;c<va[o];c++){var d=va[c];if(!(d.stop||d.el.removed)){var f=a-d.start,i=d.ms,e=d.easing,l=d.from,r=d.diff,s=d.to,u=d.t,I=d.el;d={};var K;if(f<i){f=e(f/i);for(var L in l)if(l[h](L)){switch(Oa[L]){case "along":K=f*i*r[L];s.back&&(K=s.len-K);e=Ma(s[L],K);I.translate(r.sx-r.x||0,r.sy-r.y||0);r.x=e.x;r.y=e.y;I.translate(e.x-r.sx,e.y-r.sy);s.rot&&I.rotate(r.r+e.alpha,
e.x,e.y);break;case N:K=+l[L]+f*i*r[L];break;case "colour":K="rgb("+[Xa(aa(l[L].r+f*i*r[L].r)),Xa(aa(l[L].g+f*i*r[L].g)),Xa(aa(l[L].b+f*i*r[L].b))][A](",")+")";break;case "path":K=[];e=0;for(var R=l[L][o];e<R;e++){K[e]=[l[L][e][0]];for(var ca=1,U=l[L][e][o];ca<U;ca++)K[e][ca]=+l[L][e][ca]+f*i*r[L][e][ca];K[e]=K[e][A](T)}K=K[A](T);break;case "csv":switch(L){case "translation":K=f*i*r[L][0]-u.x;e=f*i*r[L][1]-u.y;u.x+=K;u.y+=e;K=K+T+e;break;case "rotation":K=+l[L][0]+f*i*r[L][0];l[L][1]&&(K+=","+l[L][1]+
","+l[L][2]);break;case "scale":K=[+l[L][0]+f*i*r[L][0],+l[L][1]+f*i*r[L][1],2 in s[L]?s[L][2]:"",3 in s[L]?s[L][3]:""][A](T);break;case "clip-rect":K=[];for(e=4;e--;)K[e]=+l[L][e]+f*i*r[L][e]}break;default:R=[].concat(l[L]);K=[];for(e=I.paper.customAttributes[L].length;e--;)K[e]=+R[e]+f*i*r[L][e]}d[L]=K}I.attr(d);I._run&&I._run.call(I)}else{if(s.along){e=Ma(s.along,s.len*!s.back);I.translate(r.sx-(r.x||0)+e.x-r.sx,r.sy-(r.y||0)+e.y-r.sy);s.rot&&I.rotate(r.r+e.alpha,e.x,e.y)}(u.x||u.y)&&I.translate(-u.x,
-u.y);s.scale&&(s.scale+="");I.attr(s);va.splice(c--,1)}}}n.svg&&I&&I.paper&&I.paper.safari();va[o]&&setTimeout(tb)},Nb=function(a,c,d,f,i){var e=d-f;c.timeouts.push(setTimeout(function(){n.is(i,"function")&&i.call(c);c.animate(a,e,a.easing)},f))},Xa=function(a){return F(j(a,255),0)},Ka=function(a,c){if(a==null)return{x:this._.tx,y:this._.ty,toString:J};this._.tx+=+a;this._.ty+=+c;switch(this.type){case "circle":case "ellipse":this.attr({cx:+a+this.attrs.cx,cy:+c+this.attrs.cy});break;case "rect":case "image":case "text":this.attr({x:+a+
this.attrs.x,y:+c+this.attrs.y});break;case "path":var d=Qa(this.attrs.path);d[0][1]+=+a;d[0][2]+=+c;this.attr({path:d})}return this};ga.animateWith=function(a,c,d,f,i){for(var e=0,l=va.length;e<l;e++)va[e].el.id==a.id&&(c.start=va[e].start);return this.animate(c,d,f,i)};ga.animateAlong=V();ga.animateAlongBack=V(1);ga.onAnimation=function(a){this._run=a||0;return this};ga.animate=function(a,c,d,f){var i=this;i.timeouts=i.timeouts||[];if(n.is(d,"function")||!d)f=d||null;if(i.removed){f&&f.call(i);
return i}var e={},l={},r=false,s={},u;for(u in a)if(a[h](u))if(Oa[h](u)||i.paper.customAttributes[h](u)){r=true;e[u]=i.attr(u);e[u]==null&&(e[u]=Ea[u]);l[u]=a[u];switch(Oa[u]){case "along":var I=sb(a[u]),K=Ma(a[u],I*!!a.back),L=i.getBBox();s[u]=I/c;s.tx=L.x;s.ty=L.y;s.sx=K.x;s.sy=K.y;l.rot=a.rot;l.back=a.back;l.len=I;a.rot&&(s.r=X(i.rotate())||0);break;case N:s[u]=(l[u]-e[u])/c;break;case "colour":e[u]=n.getRGB(e[u]);I=n.getRGB(l[u]);s[u]={r:(I.r-e[u].r)/c,g:(I.g-e[u].g)/c,b:(I.b-e[u].b)/c};break;
case "path":I=Ha(e[u],l[u]);e[u]=I[0];L=I[1];s[u]=[];I=0;for(K=e[u][o];I<K;I++){s[u][I]=[0];for(var R=1,ca=e[u][I][o];R<ca;R++)s[u][I][R]=(L[I][R]-e[u][I][R])/c}break;case "csv":K=z(a[u]).split(E);L=z(e[u]).split(E);switch(u){case "translation":e[u]=[0,0];s[u]=[K[0]/c,K[1]/c];break;case "rotation":e[u]=L[1]==K[1]&&L[2]==K[2]?L:[0,K[1],K[2]];s[u]=[(K[0]-e[u][0])/c,0,0];break;case "scale":a[u]=K;e[u]=z(e[u]).split(E);s[u]=[(K[0]-e[u][0])/c,(K[1]-e[u][1])/c,0,0];break;case "clip-rect":e[u]=z(e[u]).split(E);
s[u]=[];for(I=4;I--;)s[u][I]=(K[I]-e[u][I])/c}l[u]=K;break;default:K=[].concat(a[u]);L=[].concat(e[u]);s[u]=[];for(I=i.paper.customAttributes[u][o];I--;)s[u][I]=((K[I]||0)-(L[I]||0))/c}}if(r){u=n.easing_formulas[d];if(!u)if((u=z(d).match(ra))&&u[o]==5){var U=u;u=function(ja){return p(ja,+U[1],+U[2],+U[3],+U[4],c)}}else u=function(ja){return ja};va.push({start:a.start||+new Date,ms:c,easing:u,from:e,diff:s,to:l,el:i,t:{x:0,y:0}});n.is(f,"function")&&(i._ac=setTimeout(function(){f.call(i)},c));va[o]==
1&&setTimeout(tb)}else{d=[];var O,Y;for(Y in a)if(a[h](Y)&&ub.test(Y)){u={value:a[Y]};Y=="from"&&(Y=0);Y=="to"&&(Y=100);u.key=na(Y,10);d.push(u)}d.sort(zb);d[0].key&&d.unshift({key:0,value:i.attrs});I=0;for(K=d[o];I<K;I++)Nb(d[I].value,i,c/100*d[I].key,c/100*(d[I-1]&&d[I-1].key||0),d[I-1]&&d[I-1].value.callback);(O=d[d[o]-1].value.callback)&&i.timeouts.push(setTimeout(function(){O.call(i)},c))}return this};ga.stop=function(){for(var a=0;a<va.length;a++)va[a].el.id==this.id&&va.splice(a--,1);a=0;for(ii=
this.timeouts&&this.timeouts.length;a<ii;a++)clearTimeout(this.timeouts[a]);this.timeouts=[];clearTimeout(this._ac);delete this._ac;return this};ga.translate=function(a,c){return this.attr({translation:a+" "+c})};ga[Z]=function(){return"Rapha\u00ebl\u2019s object"};n.ae=va;var sa=function(a){this.items=[];this[o]=0;this.type="set";if(a)for(var c=0,d=a[o];c<d;c++)if(a[c]&&(a[c].constructor==ia||a[c].constructor==sa)){this[this.items[o]]=this.items[this.items[o]]=a[c];this[o]++}};sa[G][$]=function(){for(var a,
c,d=0,f=arguments[o];d<f;d++)if((a=arguments[d])&&(a.constructor==ia||a.constructor==sa)){c=this.items[o];this[c]=this.items[c]=a;this[o]++}return this};sa[G].pop=function(){delete this[this[o]--];return this.items.pop()};for(var Ya in ga)ga[h](Ya)&&(sa[G][Ya]=function(a){return function(){for(var c=0,d=this.items[o];c<d;c++)this.items[c][a][H](this.items[c],arguments);return this}}(Ya));sa[G].attr=function(a,c){if(a&&n.is(a,P)&&n.is(a[0],"object"))for(var d=0,f=a[o];d<f;d++)this.items[d].attr(a[d]);
else{d=0;for(f=this.items[o];d<f;d++)this.items[d].attr(a,c)}return this};sa[G].animate=function(a,c,d,f){(n.is(d,"function")||!d)&&(f=d||null);var i=this.items[o],e=i,l,r=this,s;f&&(s=function(){!--i&&f.call(r)});d=n.is(d,"string")?d:s;for(l=this.items[--e].animate(a,c,d,s);e--;)this.items[e]&&!this.items[e].removed&&this.items[e].animateWith(l,a,c,d,s);return this};sa[G].insertAfter=function(a){for(var c=this.items[o];c--;)this.items[c].insertAfter(a);return this};sa[G].getBBox=function(){for(var a=
[],c=[],d=[],f=[],i=this.items[o];i--;){var e=this.items[i].getBBox();a[$](e.x);c[$](e.y);d[$](e.x+e.width);f[$](e.y+e.height)}a=j[H](0,a);c=j[H](0,c);return{x:a,y:c,width:F[H](0,d)-a,height:F[H](0,f)-c}};sa[G].clone=function(a){a=new sa;for(var c=0,d=this.items[o];c<d;c++)a[$](this.items[c].clone());return a};n.registerFont=function(a){if(!a.face)return a;this.fonts=this.fonts||{};var c={w:a.w,face:{},glyphs:{}},d=a.face["font-family"],f;for(f in a.face)a.face[h](f)&&(c.face[f]=a.face[f]);this.fonts[d]?
this.fonts[d][$](c):this.fonts[d]=[c];if(!a.svg){c.face["units-per-em"]=na(a.face["units-per-em"],10);for(var i in a.glyphs)if(a.glyphs[h](i)){d=a.glyphs[i];c.glyphs[i]={w:d.w,k:{},d:d.d&&"M"+d.d.replace(/[mlcxtrv]/g,function(l){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[l]||"M"})+"z"};if(d.k)for(var e in d.k)d[h](e)&&(c.glyphs[i].k[e]=d.k[e])}}return a};D.getFont=function(a,c,d,f){f=f||"normal";d=d||"normal";c=+c||{normal:400,bold:700,lighter:300,bolder:800}[c]||400;if(n.fonts){var i=n.fonts[a];
if(!i){a=RegExp("(^|\\s)"+a.replace(/[^\w\d\s+!~.:_-]/g,"")+"(\\s|$)","i");for(var e in n.fonts)if(n.fonts[h](e))if(a.test(e)){i=n.fonts[e];break}}var l;if(i){e=0;for(a=i[o];e<a;e++){l=i[e];if(l.face["font-weight"]==c&&(l.face["font-style"]==d||!l.face["font-style"])&&l.face["font-stretch"]==f)break}}return l}};D.print=function(a,c,d,f,i,e,l){e=e||"middle";l=F(j(l||0,1),-1);var r=this.set(),s=z(d).split(""),u=0;n.is(f,d)&&(f=this.getFont(f));if(f){d=(i||16)/f.face["units-per-em"];var I=f.face.bbox.split(E);
i=+I[0];e=+I[1]+(e=="baseline"?I[3]-I[1]+ +f.face.descent:(I[3]-I[1])/2);I=0;for(var K=s[o];I<K;I++){var L=I&&f.glyphs[s[I-1]]||{},R=f.glyphs[s[I]];u+=I?(L.w||f.w)+(L.k&&L.k[s[I]]||0)+f.w*l:0;R&&R.d&&r[$](this.path(R.d).attr({fill:"#000",stroke:"none",translation:[u,0]}))}r.scale(d,d,i,e).translate(a-i,c-e)}return r};n.format=function(a,c){var d=n.is(c,P)?[0].concat(c):arguments;a&&n.is(a,"string")&&d[o]-1&&(a=a.replace(w,function(f,i){return d[++i]==null?"":d[i]}));return a||""};n.ninja=function(){g.was?
v.Raphael=g.is:delete Raphael;return n};n.el=ga;n.st=sa[G];g.was?v.Raphael=n:Raphael=n})();(function(){function n(A){return(A+"").replace(W,"")}function Q(A,o,x){for(var B=A.length;B<o;B++)A=x?"0"+A:A+"0";return A}function S(A){return ha.call(A)==="[object Array]"}function J(A,o){if(A.indexOf)return A.indexOf(o);for(var x=0,B=A.length;x<B;x++)if(A[x]===o)return x;return-1}function V(A,o,x){var B=o["-"];o=o["+"];var F;switch(x){case "n -":B=" "+B;o=" "+o;case "n-":if(A.substr(A.length-B.length)===B)F=["-",A.substr(0,A.length-B.length)];else if(A.substr(A.length-o.length)===o)F=["+",A.substr(0,
A.length-o.length)];break;case "- n":B+=" ";o+=" ";case "-n":if(A.indexOf(B)===0)F=["-",A.substr(B.length)];else if(A.indexOf(o)===0)F=["+",A.substr(o.length)];break;case "(n)":if(A.indexOf("(")===0&&A.substr(A.length-1)===")")F=["-",A.substr(1,A.length-2)]}return F||["",A]}function p(A,o){if(!o)return 0;for(var x,B=A.getTime(),F=0,j=o.length;F<j;F++){x=o[F].start;if(x===null||B>=x)return F}return 0}function E(A){return A.split("\u00a0").join(" ").toUpperCase()}function M(A){for(var o=[],x=0,B=A.length;x<
B;x++)o[x]=E(A[x]);return o}function w(A,o,x,B){A=A.getFullYear();if(!B&&o.eras)A-=o.eras[x].offset;return A}function G(A,o){for(var x=0,B=false,F=0,j=A.length;F<j;F++){var q=A.charAt(F);switch(q){case "'":if(B)o.push("'");else x++;B=false;break;case "\\":B&&o.push("\\");B=!B;break;default:o.push(q);B=false}}return x}function h(A,o){o=o||"F";var x;x=A.patterns;var B=o.length;if(B===1){x=x[o];if(!x)throw"Invalid date format string '"+o+"'.";o=x}else if(B===2&&o.charAt(0)==="%")o=o.charAt(1);return o}
function m(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g}function v(A,o,x){A=n(A);x=x.calendar;a:{var B=x._parseRegExp;if(B){var F=B[o];if(F){o=F;break a}}else x._parseRegExp=B={};F=h(x,o).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var j=["^"],q=[],y=0,C=0,N=m(),P;(P=N.exec(F))!==null;){var Z=F.slice(y,P.index);y=N.lastIndex;C+=G(Z,j);if(C%2)j.push(P[0]);else{Z=P[0];var ka=Z.length;switch(Z){case "dddd":case "ddd":case "MMMM":case "MMM":case "gg":case "g":Z=
"(\\D+)";break;case "tt":case "t":Z="(\\D*)";break;case "yyyy":case "fff":case "ff":case "f":Z="(\\d{"+ka+"})";break;case "dd":case "d":case "MM":case "M":case "yy":case "y":case "HH":case "H":case "hh":case "h":case "mm":case "m":case "ss":case "s":Z="(\\d\\d?)";break;case "zzz":Z="([+-]?\\d\\d?:\\d{2})";break;case "zz":case "z":Z="([+-]?\\d\\d?)";break;case "/":Z="(\\"+x["/"]+")";break;default:throw"Invalid date format pattern '"+Z+"'.";}Z&&j.push(Z);q.push(P[0])}}G(F.slice(y),j);j.push("$");F=
{regExp:j.join("").replace(/\s+/g,"\\s+"),groups:q};o=B[o]=F}C=RegExp(o.regExp).exec(A);if(C===null)return null;N=o.groups;var $=A=null,da=null,la=o=null;q=j=F=B=0;P=null;y=false;Z=0;for(ka=N.length;Z<ka;Z++){var fa=C[Z+1];if(fa){var ra=N[Z],aa=ra.length,X=parseInt(fa,10);switch(ra){case "dd":case "d":o=X;if(o<1||o>31)return null;break;case "MMM":case "MMMM":da=x;aa=aa===3;ra=da.months;var na=da.monthsGenitive||da.months,wa=da._upperMonths;X=da._upperMonthsGen;if(!wa){da._upperMonths=wa=[M(ra.names),
M(ra.namesAbbr)];da._upperMonthsGen=X=[M(na.names),M(na.namesAbbr)]}fa=E(fa);da=J(aa?wa[1]:wa[0],fa);if(da<0)da=J(aa?X[1]:X[0],fa);if(da<0||da>11)return null;break;case "M":case "MM":da=X-1;if(da<0||da>11)return null;break;case "y":case "yy":case "yyyy":if(aa<4){$=x;fa=X;X=new Date;ra=p(X);if(fa<100){aa=$.twoDigitYearMax;aa=typeof aa==="string"?(new Date).getFullYear()%100+parseInt(aa,10):aa;$=w(X,$,ra);fa+=$-$%100;if(fa>aa)fa-=100}$=fa}else $=X;if($<0||$>9999)return null;break;case "h":case "hh":B=
X;if(B===12)B=0;if(B<0||B>11)return null;break;case "H":case "HH":B=X;if(B<0||B>23)return null;break;case "m":case "mm":F=X;if(F<0||F>59)return null;break;case "s":case "ss":j=X;if(j<0||j>59)return null;break;case "tt":case "t":y=x.PM&&(fa===x.PM[0]||fa===x.PM[1]||fa===x.PM[2]);if(!y&&(!x.AM||fa!==x.AM[0]&&fa!==x.AM[1]&&fa!==x.AM[2]))return null;break;case "f":case "ff":case "fff":q=X*Math.pow(10,3-aa);if(q<0||q>999)return null;break;case "ddd":case "dddd":la=fa;fa=aa===3;X=void 0;X=x.days;aa=x._upperDays;
if(!aa)x._upperDays=aa=[M(X.names),M(X.namesAbbr),M(X.namesShort)];la=E(la);if(fa){X=J(aa[1],la);if(X===-1)X=J(aa[2],la)}else X=J(aa[0],la);la=X;if(la<0||la>6)return null;break;case "zzz":aa=fa.split(/:/);if(aa.length!==2)return null;P=parseInt(aa[0],10);if(P<-12||P>13)return null;aa=parseInt(aa[1],10);if(aa<0||aa>59)return null;P=P*60+(fa.indexOf("-")===0?-aa:aa);break;case "z":case "zz":P=X;if(P<-12||P>13)return null;P*=60;break;case "g":case "gg":if(!fa||!x.eras)return null;fa=n(fa.toLowerCase());
aa=0;for(X=x.eras.length;aa<X;aa++)if(fa===x.eras[aa].name.toLowerCase()){A=aa;break}if(A===null)return null}}}C=new Date;N=(Z=x.convert)?Z.fromGregorian(C)[0]:C.getFullYear();if($===null)$=N;else if(x.eras)$+=x.eras[A||0].offset;if(da===null)da=0;if(o===null)o=1;if(Z){C=Z.toGregorian($,da,o);if(C===null)return null}else{C.setFullYear($,da,o);if(C.getDate()!==o)return null;if(la!==null&&C.getDay()!==la)return null}if(y&&B<12)B+=12;C.setHours(B,F,j,q);if(P!==null){x=C.getMinutes()-(P+C.getTimezoneOffset());
C.setHours(C.getHours()+parseInt(x/60,10),x%60)}return C}function g(A,o,x){function B(aa,X){var na;na=aa+"";if(X>1&&na.length<X){na=Z[X-2]+na;return na.substr(na.length-X,X)}return na}function F(){if(ka||$)return ka;ka=da.test(o);$=true;return ka}function j(aa,X){if(ra)return ra[X];switch(X){case 0:return aa.getFullYear();case 1:return aa.getMonth();case 2:return aa.getDate()}}var q=x.calendar,y=q.convert;if(!o||!o.length||o==="i"){if(x&&x.name.length)if(y)x=g(A,q.patterns.F,x);else{x=new Date(A.getTime());
var C=p(A,q.eras);x.setFullYear(w(A,q,C));x=x.toLocaleString()}else x=A.toString();return x}C=q.eras;var N=o==="s";o=h(q,o);x=[];var P,Z=["0","00","000"],ka,$,da=/([^d]|^)(d|dd)([^d]|$)/g,la=0,fa=m(),ra;if(!N&&y)ra=y.fromGregorian(A);for(;;){P=fa.lastIndex;y=fa.exec(o);P=o.slice(P,y?y.index:o.length);la+=G(P,x);if(!y)break;if(la%2)x.push(y[0]);else{P=y[0];y=P.length;switch(P){case "ddd":case "dddd":x.push((y===3?q.days.namesAbbr:q.days.names)[A.getDay()]);break;case "d":case "dd":ka=true;x.push(B(j(A,
2),y));break;case "MMM":case "MMMM":P=j(A,1);x.push(q.monthsGenitive&&F()?q.monthsGenitive[y===3?"namesAbbr":"names"][P]:q.months[y===3?"namesAbbr":"names"][P]);break;case "M":case "MM":x.push(B(j(A,1)+1,y));break;case "y":case "yy":case "yyyy":P=ra?ra[0]:w(A,q,p(A,C),N);if(y<4)P%=100;x.push(B(P,y));break;case "h":case "hh":P=A.getHours()%12;if(P===0)P=12;x.push(B(P,y));break;case "H":case "HH":x.push(B(A.getHours(),y));break;case "m":case "mm":x.push(B(A.getMinutes(),y));break;case "s":case "ss":x.push(B(A.getSeconds(),
y));break;case "t":case "tt":P=A.getHours()<12?q.AM?q.AM[0]:" ":q.PM?q.PM[0]:" ";x.push(y===1?P.charAt(0):P);break;case "f":case "ff":case "fff":x.push(B(A.getMilliseconds(),3).substr(0,y));break;case "z":case "zz":P=A.getTimezoneOffset()/60;x.push((P<=0?"+":"-")+B(Math.floor(Math.abs(P)),y));break;case "zzz":P=A.getTimezoneOffset()/60;x.push((P<=0?"+":"-")+B(Math.floor(Math.abs(P)),2)+":"+B(Math.abs(A.getTimezoneOffset()%60),2));break;case "g":case "gg":q.eras&&x.push(q.eras[p(A,C)].name);break;
case "/":x.push(q["/"]);break;default:throw"Invalid date format pattern '"+P+"'.";}}}return x.join("")}var k={},D={en:{}};D["default"]=D.en;k.extend=function(A){for(var o=arguments[1]||{},x=2,B=arguments.length;x<B;x++){var F=arguments[x];if(F)for(var j in F){var q=F[j];if(typeof q!=="undefined")if(A&&(ha.call(q)==="[object Object]"||S(q))){var y=o[j];y=y&&(ha.call(y)==="[object Object]"||S(y))?y:S(q)?[]:{};o[j]=this.extend(true,y,q)}else o[j]=q}}return o};k.findClosestCulture=function(A){var o;if(!A)return this.culture||
this.cultures["default"];if(ha.call(A)==="[object String]")A=A.split(",");if(S(A)){var x,B=this.cultures,F=A,j,q=F.length,y=[];for(j=0;j<q;j++){A=n(F[j]);A=A.split(";");x=n(A[0]);if(A.length===1)A=1;else{A=n(A[1]);if(A.indexOf("q=")===0){A=A.substr(2);A=parseFloat(A,10);A=isNaN(A)?0:A}else A=1}y.push({lang:x,pri:A})}y.sort(function(N,P){return N.pri<P.pri?1:-1});for(j=0;j<q;j++){x=y[j].lang;if(o=B[x])return o}for(j=0;j<q;j++){x=y[j].lang;do{F=x.lastIndexOf("-");if(F===-1)break;x=x.substr(0,F);if(o=
B[x])return o}while(1)}for(j=0;j<q;j++){x=y[j].lang;for(var C in B){F=B[C];if(F.language==x)return F}}}else if(typeof A==="object")return A;return o||null};k.preferCulture=function(A){this.culture=this.findClosestCulture(A)||this.cultures["default"]};k.localize=function(A,o,x){if(typeof o!=="string")o=this.culture.name||this.culture||"default";o=this.cultures[o]||{name:o};var B=D[o.name];if(arguments.length===3){B||(B=D[o.name]={});B[A]=x}else{if(B)x=B[A];if(typeof x==="undefined"){if(B=D[o.language])x=
B[A];if(typeof x==="undefined")x=D["default"][A]}}return typeof x==="undefined"?null:x};k.format=function(A,o,x){x=this.findClosestCulture(x);if(typeof A==="number"){var B=A;if(!o||o==="i")A=x.name.length?B.toLocaleString():B.toString();else{o=o||"D";x=x.numberFormat;A=Math.abs(B);var F=-1;if(o.length>1)F=parseInt(o.slice(1),10);var j=o.charAt(0).toUpperCase(),q;switch(j){case "D":o="n";if(F!==-1)A=Q(""+A,F,true);if(B<0)A=-A;break;case "N":q=x;case "C":q=q||x.currency;case "P":q=q||x.percent;o=B<
0?q.pattern[0]:q.pattern[1]||"n";if(F===-1)F=q.decimals;b:{var y=A*(j==="P"?100:1);j=q;q=j.groupSizes;A=q[0];B=1;var C=Math.pow(10,F),N=Math.round(y*C)/C;isFinite(N)||(N=y);C="";C=(N+"").split(/e/i);N=C.length>1?parseInt(C[1],10):0;y=C[0];C=y.split(".");y=C[0];C=C.length>1?C[1]:"";if(N>0){C=Q(C,N,false);y+=C.slice(0,N);C=C.substr(N)}else if(N<0){N=-N;y=Q(y,N+1);C=y.slice(-N,y.length)+C;y=y.slice(0,-N)}C=F>0?j["."]+(C.length>F?C.slice(0,F):Q(C,F)):"";F=y.length-1;j=j[","];for(N="";F>=0;){if(A===0||
A>F){A=y.slice(0,F+1)+(N.length?j+N+C:C);break b}N=y.slice(F-A+1,F+1)+(N.length?j+N:"");F-=A;if(B<q.length){A=q[B];B++}}A=y.slice(0,F+1)+j+N+C}break;default:throw"Bad number format specifier: "+j;}q=/n|\$|-|%/g;for(B="";;){F=q.lastIndex;j=q.exec(o);B+=o.slice(F,j?j.index:o.length);if(!j)break;switch(j[0]){case "n":B+=A;break;case "$":B+=x.currency.symbol;break;case "-":if(/[1-9]/.test(A))B+=x["-"];break;case "%":B+=x.percent.symbol}}A=B}}else if(A instanceof Date)A=g(A,o,x);return A};k.parseInt=function(A,
o,x){return Math.floor(this.parseFloat(A,o,x))};k.parseFloat=function(A,o,x){if(typeof o==="string"){x=o;o=10}x=this.findClosestCulture(x);var B=NaN,F=x.numberFormat;if(A.indexOf(x.numberFormat.currency.symbol)>-1){A=A.replace(x.numberFormat.currency.symbol,"");A=A.replace(x.numberFormat.currency["."],x.numberFormat["."])}A=n(A);if(T.test(A))B=parseFloat(A,o);else if(!o&&z.test(A))B=parseInt(A,16);else{x=V(A,F,F.pattern[0]);o=x[0];x=x[1];if(o===""&&F.pattern[0]!=="-n"){x=V(A,F,"-n");o=x[0];x=x[1]}o=
o||"+";var j;A=x.indexOf("e");if(A<0)A=x.indexOf("E");if(A<0){j=x;A=null}else{j=x.substr(0,A);A=x.substr(A+1)}var q=F["."],y=j.indexOf(q);if(y<0){x=j;j=null}else{x=j.substr(0,y);j=j.substr(y+q.length)}q=F[","];x=x.split(q).join("");y=q.replace(/\u00A0/g," ");if(q!==y)x=x.split(y).join("");o+=x;if(j!==null)o+="."+j;if(A!==null){F=V(A,F,"-n");o+="e"+(F[0]||"+")+F[1]}if(ea.test(o))B=parseFloat(o)}return B};k.parseDate=function(A,o,x){x=this.findClosestCulture(x);var B,F;if(o){if(typeof o==="string")o=
[o];if(o.length){F=0;for(var j=o.length;F<j;F++){var q=o[F];if(q)if(B=v(A,q,x))break}}}else{o=x.calendar.patterns;for(F in o)if(B=v(A,o[F],x))break}return B||null};var H=k.cultures=k.cultures||{};H=H["default"]=H.en=k.extend(true,{name:"en",englishName:"English",nativeName:"English",isRTL:false,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)",
"$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul",
"Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}}},H.en);H.calendar=H.calendar||H.calendars.standard;var W=/^\s+|\s+$/g,T=/^[+-]?infinity$/i,z=/^0x[a-f0-9]+$/i,ea=/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/,ha=Object.prototype.toString;
jQuery.global=k})();/*

 jQuery Tiny Pub/Sub - v0.3pre - 11/4/2010
 http://benalman.com/

 Copyright (c) 2010 "Cowboy" Ben Alman
 Dual licensed under the MIT and GPL licenses.
 http://benalman.com/about/license/
*/
(function(n){var Q=n({});n.subscribe=function(){Q.bind.apply(Q,arguments)};n.unsubscribe=function(){Q.unbind.apply(Q,arguments)};n.publish=function(){Q.trigger.apply(Q,arguments)}})(jQuery);/*
 
 copyright 2011, Mnemograph LLC
 Timeglider for Javascript / jQuery 
 http://timeglider.com/jquery

 Licensed under the MIT open source license
 http://timeglider.com/jquery/?p=license

*/
var timeglider=window.timeglider={version:"0.1.0"};
(function(n){n=timeglider;var Q=jQuery,S={},J={},V={},p={},E={};n.TG_Date=function(w,G){function h(k){var D=Math.abs(k.rd)*86400,H=k.ho*3600,W=(k.mi-1)*60,T=1;if(k.rd<0)T=-1;return T*(D+H+W)}var m,v,g;if(typeof w=="number"){m=v=M.getDateFromSec(w);g=w}else{if(w=="today")w=M.getToday();m=v=w}if(function(k){k=jQuery.trim(k);reg=RegExp(/[T0-9-: ]/);return reg.test(k)?k:false}(m)===false)return{error:"Invalid date"};else{m=m.replace(",","");if(m.substr(0,1)=="-"){this.bce=1;m=m.substr(1)}else this.bce=
0;m=m.replace(/[^0-9]/g,"-");m=m.split("-");this.ye=this.bce===0?parseInt(m[0],10):-1*parseInt(m[0],10);this.mo=parseInt(m[1],10);this.mo_num=this.ye>0?(this.ye-1)*12+this.mo:-1*((Math.abs(this.ye)-1)*12+(12-(this.mo-1)));this.da=parseInt(m[2],10);this.ho=parseInt(m[3],10)||0;this.mi=parseInt(m[4],10)||0;this.se=parseInt(m[5],10)||0;this.rd=M.getRataDie(this);this.sec=g||h(this);this.date_display=G?G.toLowerCase().substr(0,2):"";this.jsDate=new Date(this.ye,this.mo-1,this.da,this.ho,this.mi,this.se,
0);this.dateStr=v}};var M=n.TG_Date;M.getTimeUnitSerial=function(w,G){var h=0;switch(G){case "ye":h=w.ye;break;case "mo":h=w.mo_num;break;case "da":h=w.rd;break;case "de":h=Math.ceil(w.ye/10);break;case "ce":h=Math.ceil(w.ye/100);break;case "thou":h=Math.ceil(w.ye/1E3);break;case "tenthou":h=Math.ceil(w.ye/1E4);break;case "hundredthou":h=Math.ceil(w.ye/1E5);break;case "mill":h=Math.ceil(w.ye/1E6);break;case "tenmill":h=Math.ceil(w.ye/1E7);break;case "hundredmill":h=Math.ceil(w.ye/1E8);break;case "bill":h=
Math.ceil(w.ye/1E9)}return h};M.getMonthDays=function(w,G){return M.isLeapYear(G)==true&&w==2?29:M.monthsDayNums[w]};M.twentyFourToTwelve=function(w){var G={};G.ye=w.ye;G.mo=w.mo;G.da=w.da;G.ho=w.ho;G.mi=w.mi;G.ampm="am";if(w.ho)if(w.ho>=12){G.ampm="pm";G.ho=w.ho>12?w.ho-12:12}else if(w.ho==0){G.ho=12;G.ampm="am"}else G.ho=w.ho;else{G.ho=12;G.mi=0;G.ampm="am"}return G};M.getMonthAdj=function(w,G){var h=M.getDateFromMonthNum(w);switch(h.mo){case 1:case 3:case 5:case 7:case 8:case 10:case 12:h=Math.floor(G+
G/28*3);return{width:h,days:31};case 2:if(M.isLeapYear(h.ye)==true){h=Math.floor(G+G/28);return{width:h,days:29}}else return{width:G,days:28};default:h=Math.floor(G+G/28*2);return{width:h,days:30}}};M.getDateFromMonthNum=function(w){var G=0;if(w>0){G=w%12;if(G==0)G=12;w=Math.ceil(w/12)}else{G=Math.abs(w)%12;G=12-G+1;if(G==13)G=1;w=-1*Math.ceil(Math.abs(w)/12)}return{ye:w,mo:G}};M.getMonthWidth=function(w,G,h){G=t/28;var m;switch(w){case 1:case 3:case 5:case 7:case 8:case 10:case 12:m=3;break;case 4:case 6:case 9:case 11:m=
2;break;case 2:m=M.isLeapYear(yr)==true?1:0}return{width:Math.floor(h+G*m),numDays:28+m}};M.getToday=function(){var w=new Date;return w.getFullYear()+"-"+(w.getMonth()+1)+"-"+w.getDate()+" "+w.getHours()+":"+w.getMinutes()+":00"};M.getMonthFromRemDays=function(w,G){var h=0;var m=h=0;h=M.isLeapYear(G)?1:0;if(w<=31){m=1;h=w}else if(w>31&&w<=59+h){m=2;h=w-(31+h)}else if(w>59+h&&w<=90+h){m=3;h=w-(59+h)}else if(w>90+h&&w<=120+h){m=4;h=w-(90+h)}else if(w>120+h&&w<=151+h){m=5;h=w-(120+h)}else if(w>151+h&&
w<=181+h){m=6;h=w-(151+h)}else if(w>181+h&&w<=212+h){m=7;h=w-(181+h)}else if(w>212+h&&w<=243+h){m=8;h=w-(212+h)}else if(w>243+h&&w<=273+h){m=9;h=w-(243+h)}else if(w>273+h&&w<=304+h){m=10;h=w-(273+h)}else if(w>304+h&&w<=334+h){m=11;h=w-(304+h)}else{m=12;h=w-(334+h)}return{mo:m,da:h}};M.getDateFromRD=function(w){if(p[w])return p[w];for(var G=Math.floor(w),h=Math.floor(G/146097)*400,m=G-Math.floor(G/146097)*146097,v=1,g=h+1,k=g+400;g<=k;g++)if(m>365){m-=365;if(M.isLeapYear(g))m-=1;v++}else g=k;h+=v;
if(m==0)m=1;m=M.getMonthFromRemDays(m,h);v=(w-G)*1440;G=Math.floor(v%60);v=Math.floor(v/60);if(M.isLeapYear(h)&&m.mo==2)m.da+=1;G=h+"-"+m.mo+"-"+m.da+" "+v+":"+G+":00";return p[w]=G};M.getDateFromSec=function(w){if(E[w])return E[w];var G=M.getDateFromRD(w/86400);return E[w]=G};M.isLeapYear=function(w){return w%400==0?true:w%100==0?false:w%4==0?true:false};M.getRataDie=function(w){function G(H,W){if(J[H+"-"+W])return J[H+"-"+W];for(var T=0,z=H;z<W;z++)T+=M.isLeapYear(z)?366:365;return J[H+"-"+W]=T}
function h(H,W){var T;switch(H){case 1:T=0;break;case 2:T=31;break;case 3:T=59;break;case 4:T=90;break;case 5:T=120;break;case 6:T=151;break;case 7:T=181;break;case 8:T=212;break;case 9:T=243;break;case 10:T=273;break;case 11:T=304;break;case 12:T=334}if(H>2)if(M.isLeapYear(W))T+=1;return T}var m=w.ye,v=w.mo;w=w.da;var g=0;if(S[m+"-"+v+"-"+w])return S[m+"-"+v+"-"+w];if(m>=0){if(m==0)m=1;g=Math.floor(m/400)*146097;var k=parseInt(G(m-m%400,m)),D=parseInt(h(v,m));g=g+k+D+w-366}else if(m<0)g=M.getBCRataDie({ye:m,
mo:v,da:w});return S[m+"-"+v+"-"+w]=g};M.getBCRataDie=function(w){var G=w.ye,h=w.mo;w=w.da;if(V[G+"-"+h+"-"+w])return V[G+"-"+h+"-"+w];if(h==0)h=1;if(w==0)w=1;var m=-1*((Math.abs(G)-1)*366+[0,335,306,275,245,214,184,153,122,92,61,31,0][h]+(M.monthsDayNums[h]-w+1));return V[G+"-"+h+"-"+w]=m};M.setCulture=function(w){jQuery.global.culture=jQuery.global.cultures[w];M.monthNames=Q.merge([""],jQuery.global.culture.calendar.months.names);M.monthNamesAbbr=Q.merge([""],jQuery.global.culture.calendar.months.namesAbbr);
M.monthNamesLet=["","J","F","M","A","M","J","J","A","S","O","N","D"];M.monthsDayNums=[0,31,28,31,30,31,30,31,31,30,31,30,31,29];M.dayNames=jQuery.global.culture.calendar.days.names;M.dayNamesAbbr=jQuery.global.culture.calendar.days.namesAbbr;M.dayNamesShort=jQuery.global.culture.calendar.days.namesShort;M.units=["da","mo","ye","de","ce","thou","tenthou","hundredthou","mill","tenmill","hundredmill","bill"];M.patterns=jQuery.global.culture.calendar.patterns};M.prototype={format:function(w,G){if(G==
true)switch(this.date_display.substr(0,2)){case "no":return"";case "ye":w="yyyy";break;case "mo":w="Y";break;case "da":w="D";break;case "ho":w="f";break;default:w="f"}return Q.global.format(this.jsDate,w)}}})(timeglider);(function(n){var Q=n.levelHeight=10,S=jQuery;n.TG_Org=function(){this.blocks=[];this.ids=[];this.vis=[];this.tree=[];var J=this;this.addBlock=function(E,M){E.right=E.left+E.width;E.bottom=E.top+E.height;E.tickScope=M;J.blocks.push(E)};this.getBorg=function(){return this};this.getBlocks=function(){return this.blocks};this.getHTML=function(E,M){if(E=="sweep"){J.tree=[];for(var w=0;w<300;w++)J.tree[w]=[];this.vis=[]}this.blocks.sort(V);var G,h="",m="";b_htm=html="";b={};blength=this.blocks.length;for(var v=
title_adj=0;v<blength;v++){b=this.blocks[v];if(b.tickScope==E)if(S.inArray(b.id,this.vis)==-1){this.vis.push(b.id);title_adj=0;if(b.html&&b.html.substr(0,4)=="<div"){b_htm="<div style='left:"+b.left+"px' id='ev_"+b.id+"'"+b.html.substr(4);html+=b_htm}else{if(b.image){if(b.image.display_class=="layout")title_adj=b.image.height+4;h="<div class='timeglider-event-image-"+b.image.display_class+"'><img src='"+b.image.src+"'></div>"}else h="";p(b,0);if(b.y_position>0)b.top=-1*b.y_position;b.fontsize<10?
b.opacity=b.fontsize/10:b.opacity=1;if(b.span==true){w="timeglider-event-spanning";G="<div class='timeglider-event-spanner' style='top:"+title_adj+"px;height:"+b.fontsize+"px;width:"+b.spanwidth+"px'></div>"}else G=w="";m=b.icon?"<img class='timeglider-event-icon' src='"+b.icon+"' style='height:"+b.fontsize+"px;left:-"+(b.fontsize+2)+"px; top:"+title_adj+"px'>":"";html+=Math.abs(b.top)>M-16?"<div class='timeglider-more-plus' style='left:"+b.left+"px; top:-"+(M-Math.floor(16/3))+"px'>+</div>":"<div class='timeglider-timeline-event "+
w+"' id='ev_"+b.id+"' style='width:"+b.width+"px;height:"+b.height+"px;left:"+b.left+"px;opacity:"+b.opacity+";top:"+b.top+"px;font-size:"+b.fontsize+"px;'>"+m+h+G+"<div class='timeglider-event-title' style='top:"+title_adj+"px'>"+b.title+"</div></div>"}}}return html};var V=function(E,M){var w=M.importance,G=E.importance;return w<G?-1:w>G?1:0},p=function(E,M){var w=false,G=J.tree,h=G[M],m=M+1,v=false,g=2;bump_ht=Q;if(h!=undefined){for(g=0;g<h.length;g++){a:{w=h[g];if(!(E.left>w.right||E.right<w.left))if(E.left>=
w.left&&E.left<=w.right||E.right>=w.left&&E.right<=w.right||E.right>=w.right&&E.left<=w.left||E.right<=w.right&&E.left>=w.left)if(E.bottom<=w.bottom&&E.bottom>=w.top||E.top<=w.bottom&&E.top>=w.top||E.top==w.bottom&&E.top==w.top){w=true;break a}w=false}if(w==true){E.top-=bump_ht;E.bottom-=bump_ht;p(E,m);v=true;break}}if(v==false){E.top-=E.fontsize;h.push(E);g=Math.ceil(E.height/Q);h=0;for(h=1;h<=g;h++){m=M+h;G[m].push(E)}}}}}})(timeglider);(function(n){function Q(E){function M(m,v){return function(){return v.apply(m,arguments)}}var w=new Image,G=E.id,h=w.src=E.src;w.onerror=M(w,function(){p.reportImageSize({id:E.id,src:h,error:true})});w.onload=M(w,function(){p.reportImageSize({id:G,src:h,width:this.width,height:this.height})})}var S=n.TG_Date,J=jQuery,V={},p;n.TG_Timeline=Backbone.Model.extend({defaults:{title:"Untitled",events:[],legend:[]},_chewTimeline:function(E){p=E.mediator;V=p.options;var M={da:[],mo:[],ye:[],de:[],ce:[],thou:[],
tenthou:[],hundredthou:[],mill:[],tenmill:[],hundredmill:[],bill:[]},w=S.units;E.startSeconds=[];E.endSeconds=[];E.spans=[];E.hasImagesAbove=false;if(!E.color)E.color="#333333";if(E.events){for(var G,h,m,v,g=E.events.length,k=0;k<g;k++){h=E.events[k];if(h.id)m=h.id;else h.id=m="anon"+this.anonEventId++;G=h.date_display||h.date_limit||"da";h.date_display=G.toLowerCase().substr(0,2);h.startdateObj=new S(h.startdate,h.date_display);h.enddateObj=new S(h.enddate,h.date_display);h.icon=!h.icon||h.icon===
"none"?"":V.icon_folder+h.icon;h.titleWidth=n.getStringWidth(h.title);if(h.image){G=h.image_class||"layout";if(h.image_class=="above")E.hasImagesAbove=true;h.image={id:h.id,src:h.image,display_class:G};Q(h.image);p.imagesToSize++}E.startSeconds.push(h.startdateObj.sec);E.endSeconds.push(h.enddateObj.sec);if(h.enddateObj.sec>h.startdateObj.sec){h.span=true;E.spans.push({id:h.id,start:h.startdateObj.sec,end:h.enddateObj.sec})}else h.span=false;for(var D=w.length,H=0;H<D;H++){G=w[H];v=S.getTimeUnitSerial(h.startdateObj,
G);if(M[G][v]!==undefined)M[G][v].push(m);else M[G][v]=[m]}p.eventPool["ev_"+m]=h}w=J.merge(E.startSeconds,E.endSeconds);w=timeglider.getLowHigh(w);E.bounds={first:w.low,last:w.high}}if(E.legend.length>0){w=E.legend;for(h=0;h<w.length;h++);}E.display="expanded";E.dateHash=M;delete E.events;return E},initialize:function(E){this.set(this._chewTimeline(E))},validate:function(){}})})(timeglider);(function(n){var Q=n.TG_Date,S="",J="",V={},p=jQuery,E={},M="",w,G;debug.trace=function(h,m){p("#"+m).text(h)};n.TG_TimelineView=function(h,m){var v=this;J=m;V=J.options;S="#"+h._id;M=h._id;this._views={PLACE:S,CONTAINER:S+" .timeglider-container",TIMELINE_MENU:S+" .timeglider-timeline-menu",TIMELINE_MENU_UL:S+" .timeglider-timeline-menu ul",TIMELINE_LIST_BT:S+" .timeglider-list-bt",SLIDER_CONTAINER:S+" .timeglider-slider-container",SLIDER:S+" .timeglider-slider",ZOOM_DISPLAY:S+" .timeglider-zoomlevel-display",
TRUCK:S+" .timeglider-truck",CENTERLINE:S+" .timeglider-centerline",TICKS:S+" .timeglider-ticks",HANDLE:S+" .timeglider-handle",FOOTER:S+" .timeglider-footer",FILTER_BT:S+" .timeglider-filter-bt",FILTER_BOX:S+" .timeglider-filter-box",TOOLS_BT:S+" .timeglider-tools-bt"};w=this._views.CONTAINER;G=this._views.TICKS;this._templates={};this._templates={test:"testola",event_modal:this.getEventModalTemplate(),event_modal_video:p.template(null,"<div class='tg-modal timeglider-ev-video-modal ui-widget-content' id='${id}_modal'><div class='close-button-remove'></div><iframe width = '100%' height='300' src='${video}'></iframe></div>"),
timeline_modal:p.template(null,"<div class='tg-modal timeglider-timeline-modal ui-widget-content' id='tl_${id}_modal'><div class='close-button-remove'></div><h4 id='title'>${title}</h4><p>{{html description}}</p></div>"),filter_modal:p.template(null,"<div class='tg-modal timeglider-menu-modal timeglider-filter-box timeglider-menu-hidden'><div class='close-button'></div><h3>filter</h3><div class='timeglider-menu-modal-content'><div class='timeglider-formline'>show: <input type='text' class='timeglider-filter-include'></div><div class='timeglider-formline'>hide: <input type='text' class='timeglider-filter-exclude'></div><ul><li class='timeglider-filter-clear'>clear</li><li class='timeglider-filter-apply'>apply</li></ul></div><div class='timeglider-menu-modal-point-right'></div>"),
timeline_list_modal:p.template(null,"<div class='timeglider-menu-modal timeglider-timeline-menu timeglider-menu-hidden'><div class='close-button'></div><h3>timelines</h3><div class='timeglider-menu-modal-content'><ul></ul></div><div class='timeglider-menu-modal-point-right'></div>"),legend_modal:p.template(null,"<div class='timeglider-menu-modal timeglider-legend timeglider-menu-hidden'  id='${id}_legend'><div class='timeglider-menu-modal-content'><ul id='${id}'>{{html legend_list}}</ul><div class='timeglider-close-button-small timeglider-legend-close'></div><div class='timeglider-legend-all'>all</div></div></div>")};
p(w).css("height",p(S).height());this.basicFontSize=V.basic_fontsize;V.show_footer==false&&p(this._views.FOOTER).css("display","none");this.dragSpeed=0;this.dimensions=this.getWidgetDimensions();this.ticksHandleOffset=this.rightside=this.leftside=this.tickNum=0;this.timeoout_id=1;this.sliderActive=false;this.ztop=1E3;this.filterBoxActivated=false;this.buildSlider();this.setupFilter();p.subscribe("mediator.timelineDataLoaded",function(){p(".timeglider-loading").fadeOut(500)});p.subscribe("mediator.ticksOffsetChange",
function(){v.tickHangies();v.registerTitles();v.registerDragging()});p.subscribe("mediator.zoomLevelChange",function(){v.tickNum=0;v.leftside=0;var k=J.getZoomLevel();p(v._views.SLIDER).slider("value",v.invSliderVal(k));v.displayZoomLevel(k);v.castTicks("zoomLevelChange")});p.subscribe("mediator.ticksReadySignal",function(){J.ticksReady===true&&v.freshTimelines()});p.subscribe("mediator.refreshSignal",function(){v.tickNum=0;v.leftside=0;v.castTicks("refreshSignal")});p.subscribe("mediator.ticksArrayChange",
function(){});p.subscribe("mediator.focusDateChange",function(){});p.subscribe("mediator.timelineListChangeSignal",function(){v.buildTimelineMenu()});p.subscribe("mediator.activeTimelinesChange",function(){p(v._views.TIMELINE_MENU_UL+" li").each(function(){var k=p(this).attr("id");p.inArray(k,J.activeTimelines)!=-1?p(this).addClass("activeTimeline"):p(this).removeClass("activeTimeline")})});p.subscribe("mediator.filterChange",function(){});this.setPanButton(p(".timeglider-pan-right"),-30);this.setPanButton(p(".timeglider-pan-left"),
30);p(this._views.TRUCK).dblclick(function(k){var D=k.pageX-v.dimensions.container.offset.left-v.dimensions.container.width/2,H=J.getZoomInfo().spp;k=J.getFocusDate().sec;D=new Q(Math.floor(k+D*H));k=new Q(k);debug.trace("DBLCLICK:"+k.mo+"-"+k.ye+" DBLCLICK:"+D.mo+"-"+D.ye,"note")}).bind("mousewheel",function(k,D){var H=Math.ceil(-1*D*3),W=J.getZoomLevel();J.setZoomLevel(W+H);return false});p(G).draggable({axis:"x",drag:function(){J.setTicksOffset(p(this).position().left)},stop:function(){v.resetTicksHandle();
v.registerDragging()}}).delegate(w+" .timeglider-timeline-event","click",function(){var k=p(this).attr("id"),D=J.eventPool[k];if(D.click_callback){k=D.click_callback.split(".");var H=k[0];if(k.length==2)window[H][k[1]](D);else window[H](D)}else v.eventModal(k)}).delegate(".timeglider-timeline-event","mouseover",function(){var k=p(this).attr("id");k=J.eventPool[k];debug.trace("hover, title:"+k.title,"note");v.eventHover(p(this),k)}).delegate(".timeglider-timeline-event","mouseout",function(){var k=
p(this).attr("id");k=J.eventPool[k];debug.trace("hover, title:"+k.title,"note");v.eventUnHover(p(this),k)}).delegate(".timeglider-event-collapsed","hover",function(){var k=p(this).attr("id");debug.trace("collapsed, title:"+J.eventPool[k].title,"note")});p(w).delegate(".close-button-remove","click",function(){var k=p(this).parent().attr("id");p("#"+k).remove()});p(w).delegate(".full_modal_close","click",function(){p(".full_modal").remove()});p(w).delegate(".full_modal_scrim","click",function(){p(".full_modal").remove()});
p(w).delegate(".timeglider-more-plus","click",function(){J.zoom(-1)});p(w+" .timeglider-legend-close").live("click",function(){var k=p(w+" .timeglider-legend");k.fadeOut(300,function(){k.remove()})});p(w+" .timeglider-legend-all").live("click",function(){p(w+" .timeglider-legend li").each(function(){p(this).removeClass("tg-legend-icon-selected")});J.setFilters({origin:"legend",icon:"all"})});p.tmpl(v._templates.timeline_list_modal,{}).appendTo(w);p(v._views.TIMELINE_LIST_BT).click(function(){p(v._views.TIMELINE_MENU).toggleClass("timeglider-menu-hidden").position({my:"right bottom",
at:"right top",of:p(v._views.TIMELINE_LIST_BT),offset:"-8, -12"})});p(this._views.TIMELINE_MENU+" .close-button").live("click",function(){p(v._views.TIMELINE_MENU).toggleClass("timeglider-menu-hidden")});p(this._views.TOOLS_BT).click(function(){alert("I'm just a stand-in for the tools... ")});J.options.show_centerline===true?p(this._views.CENTERLINE).css({height:v.dimensions.container.height,left:v.dimensions.container.centerx}):p(this._views.CENTERLINE).css({display:"none"});if(p.support.touch){p("#"+
M).addTouch();var g=document.getElementById(M);g.addEventListener("gesturestart",function(k){k.preventDefault();p("#output").append("<br>gesture zoom:"+J.getZoomLevel())},false);g.addEventListener("gestureend",function(k){k.preventDefault();p("#output").append("<br>gesture end:"+J.getZoomLevel())},false);g.addEventListener("gesturechange",function(k){k.preventDefault();p("#output").append("[l:r]")},false)}};n.TG_TimelineView.prototype={getWidgetDimensions:function(){var h=p(w),m=h.width(),v=Math.floor(m/
2)+1,g=h.height(),k=Math.floor(g/2),D=h.position().left;h=h.offset();var H=V.show_footer==true?p(this._views.FOOTER).height():0;return{container:{width:m,height:g,centerx:v,centery:k,left:D,offset:h},tick:{top:g-H-30},footer:{height:H}}},getEventModalTemplate:function(){var h=this,m=false,v="",g=p.template(null,"<div class='tg-modal timeglider-ev-modal ui-widget-content' id='ev_${id}_modal'><div class='close-button-remove'></div><div class='startdate'>${startdate}</div><h4 id='title'>${title}</h4><p>{{html description}}</p><ul class='timeglider-ev-modal-links'>{{html links}}</ul></div>");
if(V.event_modal.href)p.ajax({url:V.event_modal.href,success:function(k){v=k.removeWhitespace();debug.log("stripped:"+v);h._templates.event_modal=m=p.template(null,v)},error:function(){h._templates.event_modal=m=g;alert("Custom event modal HTML file could not be found/loaded! Will revert to default.")}});else m=g;return m},scaleToImportance:function(h,m){return h/m},displayZoomLevel:function(h){h>0&&V.display_zoom_level==true&&p(this._views.ZOOM_DISPLAY).text(h)},doSomething:function(){alert("FOO DO, viewer")},
setPanButton:function(h,m){var v=this;p(h).live("mousedown",function(){v.intervalMachine("pan",{type:"set",fn:v.pan,args:[m],intvl:33})}).live("mouseup",function(){v.intervalMachine("pan",{type:"clear",fn:v.pan,callback:"resetTicksHandle"})}).live("mouseout",function(){v.intervalMachine("pan",{type:"clear",fn:v.pan,callback:"resetTicksHandle"})})},intervalMachine:function(h,m){var v=this;if(m.type==="clear"){clearInterval(E[h]);if(m.callback)v[m.callback]()}else E[h]=setInterval(function(){m.fn.apply(v,
m.args)},m.intvl)},invSliderVal:function(h){return Math.abs(h-101)},pan:function(h){h=h||20;$t=p(G);newPos=$t.position().left+h;$t.css({left:newPos});J.setTicksOffset(newPos)},registerTitles:function(){var h,m,v,g,k,D,H,W,T,z,ea,ha=p(w).offset().left;p(".timeglider-event-spanning").each(function(){h=p(this).offset().left-ha;m=p(this).outerWidth();H=p(".timeglider-event-title",this);v=H.outerWidth()+5;g=H.siblings(".timeglider-event-spanner").outerWidth();g>v&&h<0&&Math.abs(h)<m-v&&H.css({marginLeft:-1*
h+5})});p(".tg-timeline-envelope").each(function(){W=p(this).offset().left-ha;T=p(".titleBar",this);z=p(".titleBar .timeline-title",this);k=T.position().left;ea=k+W;T.outerWidth();v=T.outerWidth();D=-1*ea;ea<0&&z.css({marginLeft:D+5})})},registerDragging:function(){var h=J.startSec,m=p(G).position().left,v=J.getZoomInfo().spp;h=new Q(h-m*v);J.setFocusDate(h)},buildTimelineMenu:function(){var h,m=J.timelinePool,v=0;p(this._views.TIMELINE_MENU_UL+" li").remove();for(h in m){if(m.hasOwnProperty(h)){var g=
m[h];p(this._views.TIMELINE_MENU_UL).append("<li class = 'timelineList' id='"+h+"'>"+g.title+"</li>");p("li#"+h).click(function(){J.toggleTimeline(p(this).attr("id"))})}v++}},buildSlider:function(){var h=J.getZoomLevel();if(V.min_zoom==V.max_zoom)p(this._views.SLIDER_CONTAINER).css("display","none");else{V.display_zoom_level==true&&p("<div>").appendTo(this._views.SLIDER_CONTAINER).addClass("timeglider-zoomlevel-display").html("&nbsp;");var m=this;h=m.invSliderVal(h);var v=J.max_zoom,g=J.min_zoom;
p(this._views.SLIDER).css("height",(1+v-g)*3).slider({steps:100,handle:p(".knob"),animate:300,orientation:"vertical",min:m.invSliderVal(v),max:m.invSliderVal(g),value:h,start:function(){m.sliderActive=true},stop:function(){m.sliderActive=false},change:function(){},slide:function(k,D){J.setZoomLevel(m.invSliderVal(D.value))}})}},eventHover:function(h,m){var v=p(".timeglider-event-hover-info");m.date_display!="no"&&v.position({my:"left bottom",at:"left top",of:h,offset:"1, -10",collision:"flip flip"}).text(m.startdateObj.format("D",
true));h.addClass("tg-event-hovered")},eventUnHover:function(h){p(".timeglider-event-hover-info").css("left","-1000px");h.removeClass("tg-event-hovered")},setupFilter:function(){var h=this;p.tmpl(h._templates.filter_modal,{}).appendTo(h._views.CONTAINER);p(h._views.FILTER_BT).click(function(){var m=p(this),v=h._views.FILTER_BOX;if(h.filterBoxActivated==false){h.filterBoxActivated=true;var g=p(v+" .timeglider-filter-apply"),k=p(".timeglider-filter-box .close-button"),D=p(v+" .timeglider-filter-clear"),
H="",W="";g.click(function(){H=p(v+" .timeglider-filter-include").val();W=p(v+" .timeglider-filter-exclude").val();J.setFilters({origin:"clude",include:H,exclude:W});p(v).toggleClass("timeglider-menu-shown")});k.click(function(){p(v).toggleClass("timeglider-menu-hidden")});D.click(function(){J.setFilters({origin:"clude",include:"",exclude:""});p(v+" .timeglider-filter-include").val("");p(v+" .timeglider-filter-exclude").val("");p(v).toggleClass("timeglider-menu-shown")})}p(v).toggleClass("timeglider-menu-hidden").css("z-index",
h.ztop++).position({my:"right bottom",at:"right top",of:m,offset:"-8, -12"})})},clearTicks:function(){this.tickNum=this.leftside=0;p(G).css("left",0).html("<div class='timeglider-handle'></div>")},castTicks:function(){this.clearTicks();J.getZoomLevel();var h=J.getFocusDate(),m=J.getZoomInfo().width;m=Math.ceil(this.dimensions.container.width/m)+4;var v="l";J.setTicksReady(false);this.addTick({type:"init",focus_date:h});for(h=1;h<=m;h+=1){this.addTick({type:v});v=v=="l"?"r":"l"}J.setTicksReady(true)},
addTick:function(h){var m=0,v=0,g=v=0,k=0,D=0,H="";D={};g={};var W={},T={};D={};W=J.getZoomInfo().unit;T=J.getZoomInfo().width;k=J.getFocusDate();g=parseInt(this.dimensions.tick.top);k=J.addToTicksArray({type:h.type,unit:W},k);var z="",ea=0;H="";if(W=="mo"){D=Q.getMonthAdj(k,T);T=D.width;m=D.days}this.tickNum++;if(h.type=="init"){D=this.tickOffsetFromDate(J.getZoomInfo(),J.getFocusDate(),T);this.leftside=v=Math.ceil(this.dimensions.container.centerx+D);this.rightside=v+T}else if(h.type=="l")this.leftside=
v=Math.floor(this.leftside-T);else if(h.type=="r"){v=Math.floor(this.rightside);this.rightside+=T}J.getTickBySerial(k).width=T;J.getTickBySerial(k).left=v;H=this._views.PLACE+"_"+W+"_"+k+"-"+this.tickNum;D=p("<div class='timeglider-tick' id='"+H+"'><div class='timeglider-tick-label' id='label'></div></div>").appendTo(G);D.css({width:T,left:v,top:g});g=this.getTickMarksInfo({unit:W,width:T});g=m||g.tperu;v=T/g;if(v>5){h=Raphael(H,T,30);var ha="";for(m=0;m<g;++m){H=m*v;ha+="M"+H+" 20 L"+H+" 30";if(W==
"da"&&v>16){H=this.getHourLabelFromHour(ea,v);z+="<div class='timeglider-tick-hour-label' style='width:"+(v-4)+"px'>"+H+"</div>";ea++}}h.path(ha).attr({stroke:"#333","stroke-width":1})}W=="da"&&v>32&&D.append("<div style='position:absolute;top:14px;left:0'>"+z+"</div>");W={unit:W,width:T,serial:k};T=this.getDateLabelForTick(W);D.children("#label").text(T);return W},getHourLabelFromHour:function(h,m){var v="";v=v="";v=h>12?h-12:h;if(v==0)v=12;return v+(m>60?":00":"")+(h>11?" pm":" am")},getTickMarksInfo:function(h){switch(h.unit){case "da":h=
24;break;case "mo":h=30;break;case "ye":h=12;break;default:h=10}return{tperu:h}},getDateLabelForTick:function(h){var m=h.serial,v=h.width;switch(h.unit){case "bill":return m==0?"1":m>0?m+" billion":m+" b.y. bce";case "hundredmill":return m==0?"1":m>0?m+"00 million":m+"00 m.y. bce";case "tenmill":return m==0?"1":m>0?m+"0 million":m+"0 m.y. bce";case "mill":return m==0?"1":m>0?m+" million":m+" m.y. bce";case "hundredthou":return m==0?"1":m>0?m+"00,000":m+"00,000 bce";case "tenthou":return m==0?"1":
m+"0,000";case "thou":return m==0?"1":m+"000";case "ce":return m==0?"1":m+"00";case "de":return m*10;case "ye":return m;case "mo":h=Q.getDateFromMonthNum(m);return v<120?Q.monthNamesAbbr[h.mo]+" "+h.ye:Q.monthNames[h.mo]+", "+h.ye;case "da":h=new Q(Q.getDateFromRD(m));return v<120?Q.monthNamesAbbr[h.mo]+" "+h.da+", "+h.ye:Q.monthNames[h.mo]+" "+h.da+", "+h.ye;default:return h.unit+":"+m+":"+v}},tickHangies:function(){var h=p(G).position().left,m=this.rightside+h-this.dimensions.container.width;if(this.leftside+
h>-100){h=this.addTick({type:"l"});this.appendTimelines(h)}else if(m<100){h=this.addTick({type:"r"});this.appendTimelines(h)}},tickOffsetFromDate:function(h,m,v){switch(h.unit){case "da":m=m.ho/24+m.mi/1440;v*=m;break;case "mo":h=Q.getMonthDays(m.mo,m.ye);m=(m.da-1)/h+m.ho/(24*h)+m.mi/(1440*h);v*=m;break;case "ye":m=((m.mo-1)*30+m.da)/365;v*=m;break;case "de":m=m.ye%10/10+m.mo/120;v*=m;break;case "ce":m=m.ye%100/100+m.mo/1200;v*=m;break;case "thou":m=m.ye%1E3/1E3;v*=m;break;case "tenthou":m=m.ye%
1E4/1E4;v*=m;break;case "hundredthou":m=m.ye%1E5/1E5;v*=m;break;default:v=0}return-1*v},resetTicksHandle:function(){p(this._views.HANDLE).offset({left:p(w).offset().left})},easeOutTicks:function(){Math.abs(this.dragSpeed)>5&&debug.trace("ticks stopped!","note")},getTimelineEventsByTick:function(h){var m=h.tick.unit,v=h.tick.serial;h=h.timeline.dateHash;return h[m][v]&&h[m][v].length>0?h[m][v]:0},setTimelineProp:function(h,m,v){J.timelinePool[h][m]=v},getTimelineProp:function(h,m){return J.timelinePool[h][m]},
passesFilters:function(h,m){var v=true,g="",k=[],D;g="";k=[];if(m<h.low_threshold||m>h.high_threshold)return false;if(g=J.filters.include){k=g.split(",");v=false;for(D=0;D<k.length;D++){g=RegExp(p.trim(k[D]),"i");if(h.title.match(g))v=true}}if(g=J.filters.exclude){k=g.split(",");for(D=0;D<k.length;D++){g=RegExp(p.trim(k[D]),"i");if(h.title.match(g))v=false}}g=h.icon;if(J.filters.legend.length>0)if(p.inArray(g,J.filters.legend)==-1)v=false;return v},freshTimelines:function(){var h,m,v,g,k=J.activeTimelines,
D=J.ticksArray,H="",W,T=this;m="";var z=T.dimensions.container.centerx,ea=T.dimensions.container.width,ha=J.getFocusDate().sec,A=J.getZoomInfo().spp;J.getZoomInfo();m=[];var o=[];ea=ha-Math.floor(A*(ea/2));m="";for(var x,B=0,F=T.dimensions.container.height,j=B=0;j<k.length;j++){h=J.timelinePool[k[j]];x=h.display;B=h.top?parseInt(h.top.replace("px","")):F-120;m=h.legend.length>0?"<span class='tg-timeline-legend-bt'>legend</span>":"";$tl=p("<div class='tg-timeline-envelope' id='"+h.id+"'><div class='titleBar'><div class='timeline-title'>"+
h.title+"<div class='tg-timeline-env-buttons'><span class='timeline-info'>info</span>"+m+"</div></div></div></div>").appendTo(G);$tl.draggable({axis:"y",handle:".titleBar",stop:function(){T.setTimelineProp(h.id,"top",p(this).css("top"));J.refresh()}}).css("top",B);m=$tl.height();p(w+" .tg-timeline-envelope#"+h.id+" .titleBar .expand-collapse").click(function(){T.expandCollapseTimeline(h.id)});p(w+" .tg-timeline-envelope#"+h.id+" .titleBar .timeline-info").click(function(){T.timelineModal(h.id)});
p(w+" .tg-timeline-envelope#"+h.id+" .titleBar .tg-timeline-legend-bt").click(function(){T.legendModal(h.id)});W=$tl.children(".titleBar");v=z+(h.bounds.first-ha)/A;g=z+(h.bounds.last-ha)/A;W.css({top:m,left:v,width:g-v});if(x=="expanded")h.borg=H=new timeglider.TG_Org;for(v=0;v<D.length;v++){m=this.getTimelineEventsByTick({tick:D[v],timeline:h});p.merge(o,m)}for(v=0;v<h.spans.length;v++){m=h.spans[v];m.start<ea&&m.end>ea&&p.inArray(m.id,o)==-1&&o.unshift(m.id)}m=this.compileTickEventsAsHtml(h,o,
0,"sweep");B=h.hasImagesAbove?B-56:B;if(x=="expanded"){m=H.getHTML("sweep",B);h.borg=H.getBorg()}m!="undefined"&&$tl.append(m);this.registerEventImages($tl)}T.registerTitles()},appendTimelines:function(h){for(var m=J.activeTimelines,v,g="",k=0;k<m.length;k++){v=J.timelinePool[m[k]];idArr=this.getTimelineEventsByTick({tick:h,timeline:v});g=this.compileTickEventsAsHtml(v,idArr,h.serial,"append");if(v.display=="expanded")g=v.borg.getHTML(h.serial,v.top);v=p(".tg-timeline-envelope#"+v.id).append(g);this.registerEventImages(v)}},
compileTickEventsAsHtml:function(h,m,v,g){var k;k=0;var D=this.dimensions.container.centerx,H=h.display,W=$tl.height();stuff="";foSec=J.startSec;spp=J.getZoomInfo().spp;zl=J.getZoomInfo().level;buffer=20;borg=h.borg;block_arg="sweep";if(g=="append")block_arg=v;for(v=0;v<m.length;v++){ev=J.eventPool["ev_"+m[v]];if(this.passesFilters(ev,zl)===true){k=D+(ev.startdateObj.sec-foSec)/spp;if(H=="expanded"){impq=h.size_importance!==false?this.scaleToImportance(ev.importance,zl):1;ev.width=ev.titleWidth*impq+
buffer;ev.fontsize=this.basicFontSize*impq;ev.left=k;ev.spanwidth=0;if(ev.span==true){ev.spanwidth=(ev.enddateObj.sec-ev.startdateObj.sec)/spp;if(ev.spanwidth>ev.width)ev.width=ev.spanwidth}k=0;if(ev.image&&ev.image.display_class==="layout"){k=ev.image.height+2;ev.width=ev.image.width>ev.width?ev.image.width:ev.width}ev.height=Math.ceil(ev.fontsize)+k;ev.top=W-ev.height;borg.addBlock(ev,block_arg)}else if(H=="collapsed")stuff+="<div id='ev_"+ev.id+"' class='timeglider-event-collapsed' style='top:"+
(W-2)+"px;left:"+k+"px'></div>"}}return H=="collapsed"?stuff:""},registerEventImages:function(h){p(".timeglider-event-image-bar").each(function(){p(this).position({my:"top",at:"bottom",of:h,offset:"0, 0"}).css("left",0)});p(".timeglider-event-image-above").each(function(){p(this).position({my:"top",at:"top",of:p(w),offset:"0, 12"}).css("left",0)})},expandCollapseTimeline:function(h){h=J.timelinePool[h];h.display=h.display=="expanded"?"collapsed":"expanded";J.refresh()},timelineModal:function(h){p("#tl_"+
h+"_modal").remove();var m=J.timelinePool[h];p.tmpl(this._templates.timeline_modal,{title:m.title,description:m.description,id:h}).appendTo(w).css("z-index",this.ztop++).position({my:"left top",at:"left top",of:this._views.CONTAINER,offset:"32, 32",collision:"fit fit"}).draggable({stack:".timeglider-modal"})},createEventLinksMenu:function(h,m){if(!h)return"";var v="",g=0,k="",D="";if(m=="full")v+="<li><h4>links</h4></li>";if(typeof h=="string")v="<li><a href='"+h+"' target='_blank'>link</a></li>";
else if(typeof h=="object")for(g=0;g<h.length;g++){k=h[g].url;D=h[g].label;v+="<li><a href='"+k+"' target='_blank'>"+D+"</a></li>"}return v},eventModal:function(h){p("#ev_"+h+"_modal").remove();var m=this,v=V.event_modal.type,g=p("#"+h),k=m._templates.event_modal;ev=J.eventPool[h];ev_img=ev.image&&ev.image.src?"<img src='"+ev.image.src+"'>":"";ev_img_src=ev.image&&ev.image.src?ev.image.src:"";links=this.createEventLinksMenu(ev.link,v);ev_descr=v=="default"?ev_img+ev.description:ev.description;templ_obj=
{title:ev.title,description:ev_descr,id:h,startdate:ev.startdateObj.format("D",true),links:links,image:ev_img_src,video:ev.video};if(ev.video){k=m._templates.event_modal_video;templ_obj.video=ev.video}h=p.tmpl(k,templ_obj);switch(v){case "full":h.appendTo(w).css("z-index",m.ztop++).position({my:"left top",at:"left top",of:w,offset:"0, 0",collision:"none none"});break;default:h.appendTo(G).css("z-index",m.ztop++).position({my:"right center",at:"left center",of:g,offset:"-12, -1",collision:"flip fit"}).draggable().hover(function(){p(this).css("z-index",
m.ztop++)})}},legendModal:function(h){var m=J.timelinePool[h].legend,v,g,k,D="";for(v=0;v<m.length;v++){g=V.icon_folder+m[v].icon;k=m[v].title;D+="<li><img src='"+g+"'>"+k+"</li>"}h={id:h,legend_list:D};p(w+" .timeglider-legend").remove();p.tmpl(this._templates.legend_modal,h).appendTo(w).css("z-index",this.ztop++).toggleClass("timeglider-menu-hidden").position({my:"left top",at:"left top",of:w,offset:"16, -4",collision:"none none"});p(w+" .timeglider-legend li").click(function(){p(this).parent().attr("id");
var H=p(this).children("img").attr("src");p(this).toggleClass("tg-legend-icon-selected");J.setFilters({origin:"legend",icon:H})})},parseHTMLTable:function(h){var m={},v=+new Date,g=[];p("#"+h).find("tr").each(function(k){var D=p(this).children(),H;if(k===0)g=D.map(function(){return p(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get();else{H={};D.each(function(W){H[g[W]]=p(this).text()});m["prefix"+v++]=H}});return m}};n.zoomTree=[{},{unit:"da",width:35E3,level:1,label:"5 hours"},{unit:"da",
width:17600,level:2,label:"7 hours"},{unit:"da",width:8800,level:3,label:"10 hours"},{unit:"da",width:4400,level:4,label:"12 hours"},{unit:"da",width:2200,level:5,label:"14 hours"},{unit:"da",width:1100,level:6,label:"17 hours"},{unit:"da",width:550,level:7,label:"22 hours"},{unit:"da",width:432,level:8,label:"1 DAY"},{unit:"da",width:343,level:9,label:"1.5 days"},{unit:"da",width:272,level:10,label:"2 days"},{unit:"da",width:216,level:11,label:"2.5 days"},{unit:"da",width:171,level:12,label:"3 days"},
{unit:"da",width:136,level:13,label:"3.5 days"},{unit:"da",width:108,level:14,label:"4 days"},{unit:"mo",width:2509,level:15,label:"6 days"},{unit:"mo",width:1945,level:16,label:"1 WEEK"},{unit:"mo",width:1508,level:17,label:"10 days"},{unit:"mo",width:1169,level:18,label:"2 weeks"},{unit:"mo",width:913,level:19,label:"2.5 weeks"},{unit:"mo",width:719,level:20,label:"3 weeks"},{unit:"mo",width:566,level:21,label:"3.5 weeks"},{unit:"mo",width:453,level:22,label:"1 MONTH"},{unit:"mo",width:362,level:23,
label:"5.5 weeks"},{unit:"mo",width:290,level:24,label:"7 weeks"},{unit:"mo",width:232,level:25,label:"2 months"},{unit:"mo",width:186,level:26,label:"2.5 months"},{unit:"mo",width:148,level:27,label:"3 months"},{unit:"mo",width:119,level:28,label:"4 months"},{unit:"mo",width:95,level:29,label:"5 months"},{unit:"mo",width:76,level:30,label:"6 months"},{unit:"ye",width:723,level:31,label:"9 months"},{unit:"ye",width:573,level:32,label:"1 YEAR"},{unit:"ye",width:455,level:33,label:"1.25 years"},{unit:"ye",
width:361,level:34,label:"1.5 years"},{unit:"ye",width:286,level:35,label:"2 years"},{unit:"ye",width:227,level:36,label:"2.5 years"},{unit:"ye",width:179,level:37,label:"3 years"},{unit:"ye",width:142,level:38,label:"4 years"},{unit:"ye",width:113,level:39,label:"5 years"},{unit:"ye",width:89,level:40,label:"6 years"},{unit:"de",width:705,level:41,label:"8 years"},{unit:"de",width:559,level:42,label:"10 years"},{unit:"de",width:443,level:43,label:"13 years"},{unit:"de",width:302,level:44,label:"16 years"},
{unit:"de",width:240,level:45,label:"20 years"},{unit:"de",width:190,level:46,label:"25 years"},{unit:"de",width:150,level:47,label:"30 years"},{unit:"de",width:120,level:48,label:"40 years"},{unit:"de",width:95,level:49,label:"50 years"},{unit:"de",width:76,level:50,label:"65 years"},{unit:"ce",width:600,level:51,label:"80 years"},{unit:"ce",width:480,level:52,label:"100 years"},{unit:"ce",width:381,level:53,label:"130 years"},{unit:"ce",width:302,level:54,label:"160 years"},{unit:"ce",width:240,
level:55,label:"200 years"},{unit:"ce",width:190,level:56,label:"250 years"},{unit:"ce",width:150,level:57,label:"300 years"},{unit:"ce",width:120,level:58,label:"400 years"},{unit:"ce",width:95,level:59,label:"500 years"},{unit:"ce",width:76,level:60,label:"600 years"},{unit:"thou",width:603,level:61,label:"1000 years"},{unit:"thou",width:478,level:62,label:"1200 years"},{unit:"thou",width:379,level:63,label:"1800 years"},{unit:"thou",width:301,level:64,label:"160 years"},{unit:"thou",width:239,
level:65,label:"xxx years"},{unit:"thou",width:190,level:66,label:"xxx years"},{unit:"thou",width:150,level:67,label:"xxx years"},{unit:"thou",width:120,level:68,label:"xxx years"},{unit:"thou",width:95,level:69,label:"8,000 years"},{unit:"thou",width:76,level:70,label:"10,000 years"},{unit:"tenthou",width:603,level:71,label:"15,000 years"},{unit:"tenthou",width:358,level:72,label:"20,000 years"},{unit:"tenthou",width:213,level:73,label:"30,000 years"},{unit:"tenthou",width:126,level:74,label:"60,000 years"},
{unit:"tenthou",width:76,level:75,label:"100,000 years"},{unit:"hundredthou",width:603,level:76,label:"180,000 years"},{unit:"hundredthou",width:358,level:77,label:"300,000 years"},{unit:"hundredthou",width:213,level:78,label:"500,000 years"},{unit:"hundredthou",width:126,level:79,label:"800,000 years"},{unit:"hundredthou",width:76,level:80,label:"1 million years"},{unit:"mill",width:603,level:81,label:"1.2 million years"},{unit:"mill",width:358,level:82,label:"2 million years"},{unit:"mill",width:213,
level:83,label:"3 million years"},{unit:"mill",width:126,level:84,label:"5 million years"},{unit:"mill",width:76,level:85,label:"10 million years"},{unit:"tenmill",width:603,level:86,label:"15 million years"},{unit:"tenmill",width:358,level:87,label:"30 million years"},{unit:"tenmill",width:213,level:88,label:"50 million years"},{unit:"tenmill",width:126,level:89,label:"80 million years"},{unit:"tenmill",width:76,level:90,label:"100 million years"},{unit:"hundredmill",width:603,level:91,label:"120 million years"},
{unit:"hundredmill",width:358,level:92,label:"200 million years"},{unit:"hundredmill",width:213,level:93,label:"300 million years"},{unit:"hundredmill",width:126,level:94,label:"500 million years"},{unit:"hundredmill",width:76,level:95,label:"1 billion years"},{unit:"bill",width:603,level:96,label:"15 million years"},{unit:"bill",width:358,level:97,label:"30 million years"},{unit:"bill",width:213,level:98,label:"50 million years"},{unit:"bill",width:126,level:99,label:"80 million years"},{unit:"bill",
width:76,level:100,label:"100 billion years"}];n.calculateSecPerPx=function(h){for(var m=1;m<h.length;m++){var v=h[m],g=0;switch(v.unit){case "da":g=86400;break;case "mo":g=2419200;break;case "ye":g=31536E3;break;case "de":g=31536E4;break;case "ce":g=31536E5;break;case "thou":g=31536E6;break;case "tenthou":g=31536E7;break;case "hundredthou":g=31536E8;break;case "mill":g=31536E9;break;case "tenmill":g=31536E10;break;case "hundredmill":g=31536E11;break;case "bill":g=31536E12}v.spp=g/parseInt(v.width)}}(n.zoomTree);
n.getStringWidth=function(h){if(h)return p("#timeglider-measure-span").html(h).width()};String.prototype.removeWhitespace=function(){return this.replace(RegExp("\\n","g"),"")}})(timeglider);(function(n){var Q={},S=n.TG_Date,J={},V=jQuery;n.TimelineCollection=Backbone.Collection.extend({model:timeglider.TG_Timeline});n.TG_Mediator=function(p){this.options=J=p;this._focusDate={};this._zoomInfo={};this._zoomLevel=1;this.ticksReady=false;this.ticksArray=[];this.startSec=0;this.activeTimelines=[];this.max_zoom=J.max_zoom;this.min_zoom=J.min_zoom;this.fixed_zoom=this.max_zoom==this.min_zoom?true:false;this.gesturing=false;this.gestureStartScale=this.gestureStartZoom=0;this.filters={include:"",
exclude:"",legend:[]};this.eventPool=[];this.timelinePool={};this.imagesToSize=this.imagesSized=0;this.timelineDataLoaded=false;this.foo="bark";this.initial_timeline_id=J.initial_timeline_id||"";this.sole_timeline_id="";if(J.max_zoom===J.min_zoom)this.fixed_zoom=J.min_zoom;Q=this};n.TG_Mediator.prototype={gotoDateZoom:function(p,E){var M=false;this.setFocusDate(new S(p));if(E)M=this.setZoomLevel(E);if(!E||M==false)this.refresh()},zoom:function(p){this.setZoomLevel(this.getZoomLevel()+parseInt(p))},
loadTimelineData:function(p){var E=this;if(p)if(typeof p==="object")E.parseData(p);else if(p.substr(0,1)=="#"){p=[E.getTableTimelineData(p)];E.parseData(p)}else V.getJSON(p,function(M){E.parseData(M)});else{this.timelineDataLoaded=true;this.setZoomLevel(Math.floor((this.max_zoom+this.min_zoom)/2));this.tryLoading()}},getTableTimelineData:function(p){var E={},M=0,w=[],G,h,m="",v=V(p);E.id=p.substr(1);E.title=v.attr("title")||"untitled";E.description=v.attr("description")||"";E.focus_date=v.attr("focus_date")||
S.getToday;E.initial_zoom=v.attr("initial_zoom")||20;E.events=[];v.find("tr").each(function(g){var k=V(this).children(),D;if(g===0)w=k.map(function(){return V(this).attr("class").replace(/^.*?\btg-(\S+)\b.*?$/,"$1")}).get();else{D={};k.each(function(H){G=w[H];h=V(this).text();D[G]=h});m="ev_"+M++;D.id=m;E.events.push(D)}});v.css("display","none");return E},parseData:function(p){var E=0,M=p.length,w={};w={};for(var G=0;G<M;G++){w=p[G];w.mediator=this;w=(new timeglider.TG_Timeline(w)).toJSON();if(w.id.length>
0){E++;this.swallowTimeline(w)}}if(E===0)alert("ERROR loading data: Check JSON with jsonLint");else{this.timelineDataLoaded=true;this.tryLoading()}},tryLoading:function(){var p=this.timelineDataLoaded==true;if(this.imagesSized==this.imagesToSize&&p){this.setInitialTimelines();V.publish("mediator.timelineDataLoaded")}},swallowTimeline:function(p){this.sole_timeline_id=p.id;this.timelinePool[p.id]=p;V.publish("mediator.timelineListChangeSignal")},setInitialTimelines:function(){var p=this.initial_timeline_id||
this.sole_timeline_id;p&&setTimeout(function(){Q.toggleTimeline(p)},1E3)},refresh:function(){this.startSec=this._focusDate.sec;V.publish("mediator.refreshSignal")},setTicksReady:function(p){this.ticksReady=p;p===true&&V.publish("mediator.ticksReadySignal")},getFocusDate:function(){return this._focusDate},setFocusDate:function(p){if(p!=this._focusDate)this._focusDate=p},getZoomLevel:function(){return parseInt(this._zoomLevel)},setZoomLevel:function(p){if(p<=this.max_zoom&&p>=this.min_zoom){this.startSec=
this._focusDate.sec;if(p!=this._zoomLevel){this._zoomLevel=p;this._zoomInfo=timeglider.zoomTree[p];V.publish("mediator.zoomLevelChange");return true}else return false}else return false},getZoomInfo:function(){return this._zoomInfo},setFilters:function(p){switch(p.origin){case "clude":this.filters.include=p.include;this.filters.exclude=p.exclude;break;case "legend":var E=p.icon;if(E=="all"){this.filters.legend=[];V.publish("mediator.legendAll")}else if(V.inArray(E,this.filters.legend)==-1)this.filters.legend.push(E);
else{p=[];p=V.grep(this.filters.legend,function(M){return M!=E});this.filters.legend=p}}V.publish("mediator.filtersChange");this.refresh()},getTicksOffset:function(){return this._ticksOffset},setTicksOffset:function(p){this._ticksOffset=p;V.publish("mediator.ticksOffsetChange")},getTickBySerial:function(p){for(var E=this.ticksArray,M=E.length,w=0;w<M;w++){var G=E[w];if(G.serial==p)return G}return false},addToTicksArray:function(p,E){if(p.type=="init"){p.serial=S.getTimeUnitSerial(E,p.unit);this.ticksArray=
[p]}else if(p.type=="l"){p.serial=this.ticksArray[0].serial-1;this.ticksArray.unshift(p)}else{p.serial=this.ticksArray[this.ticksArray.length-1].serial+1;this.ticksArray.push(p)}V.publish("mediator.ticksArrayChange");return p.serial},toggleTimeline:function(p){var E=this.timelinePool[p],M=V.inArray(p,this.activeTimelines);if(M==-1){this.activeTimelines.push(p);this.setFocusDate(new S(E.focus_date));this.setZoomLevel(E.initial_zoom)}else this.activeTimelines.splice(M,1);this.refresh();V.publish("mediator.activeTimelinesChange")},
reportImageSize:function(p){var E=Q.eventPool["ev_"+p.id];if(p.error){E.image={};debug.log("WHOOPS: MISSING IMAGE: "+p.src)}else{E.image.width=p.width;E.image.height=p.height}this.imagesSized++;this.imagesSized==this.imagesToSize&&this.tryLoading()}};n.getLowHigh=function(p){var E,M,w=parseFloat(p[0]),G=w;for(E=0;E<p.length;E++){M=parseFloat(p[E]);if(M<G)G=M;if(M>w)w=M}return{high:w,low:G}};n.validateOptions=function(p){this.optionsMaster={initial_focus:{type:"date"},editor:{type:"string"},backgroundColor:{type:"color"},
backgroundImage:{type:"color"},min_zoom:{type:"number",min:1,max:100},max_zoom:{type:"number",min:1,max:100},initial_zoom:{type:"number",min:1,max:100},show_centerline:{type:"boolean"},display_zoom_level:{type:"boolean"},data_source:{type:"url"},basic_fontsize:{type:"number",min:9,max:100},mouse_wheel:{type:"string",possible:["zoom","pan"]},initial_timeline_id:{type:"string"},icon_folder:{type:"string"},show_footer:{type:"boolean"},display_zoom_level:{type:"boolean"},event_modal:{type:"object"}};
var E=this,M="";V.each(p,function(w,G){if(E.optionsMaster[w])switch(E.optionsMaster[w].type){case "string":if(typeof G!="string")M+=w+" needs to be a string.\n";if(E.optionsMaster[w].possible)if(V.inArray(G,E.optionsMaster[w].possible)==-1)M+=w+" must be: "+E.optionsMaster[w].possible.join(" or ");break;case "number":if(typeof G!="number")M+=G+" needs to be a number.\n";if(E.optionsMaster[w].min)if(G<E.optionsMaster[w].min)M+=w+" must be greater than or equal to "+E.optionsMaster[w].min+"\n";if(E.optionsMaster[w].max)if(G>
E.optionsMaster[w].max)M+=w+" must be less than or equal to "+E.optionsMaster[w].max+"\n";break;case "boolean":if(typeof G!="boolean")M+=G+" needs to be a number.\n"}});return M}})(timeglider);(function(n){var Q,S,J=timeglider,V=timeglider.TG_Date;n.widget("timeglider.timeline",{options:{initial_focus:J.TG_Date.getToday(),editor:"none",min_zoom:1,max_zoom:100,show_centerline:true,data_source:"",culture:"en",basic_fontsize:12,mouse_wheel:"zoom",initial_timeline_id:"",icon_folder:"js/timeglider/icons/",show_footer:true,display_zoom_level:true,event_modal:{href:"",type:"default"}},_create:function(){this._id=n(this.element).attr("id");this.element.html("<div class='timeglider-container'><div class='timeglider-loading'>loading</div><div class='timeglider-centerline'></div><div class='timeglider-truck' id='tg-truck'><div class='timeglider-ticks'><div class='timeglider-handle'></div></div></div><div class='timeglider-slider-container'><div class='timeglider-slider'></div><div class='timeglider-pan-buttons'><div class='timeglider-pan-left'></div><div class='timeglider-pan-right'></div></div></div><div class='timeglider-footer'><div class='timeglider-logo'></div><img class='timeglider-filter-bt' title='filter' src='js/timeglider/buttons/filter.png'><img class='timeglider-tools-bt' title='settings' src='js/timeglider/buttons/tools.png'><img class='timeglider-list-bt' title='timelines' src='js/timeglider/buttons/list.png'></div><div class='timeglider-event-hover-info'></div></div><span id='timeglider-measure-span'></span>")},
_init:function(){var p=timeglider.validateOptions(this.options);if(p==""){J.TG_Date.setCulture(this.options.culture);S=new J.TG_Mediator(this.options);Q=new J.TG_TimelineView(this,S);S.setFocusDate(new V(this.options.initial_focus));S.loadTimelineData(this.options.data_source)}else alert("Rats. There's a problem with your widget settings:"+p)},goTo:function(p,E){S.gotoDateZoom(p,E)},zoom:function(p){p=0;switch(p){case "in":p=-1;break;case "out":p=1}if(p>99||p<-99)return false;S.zoom(p)},panButton:function(p,
E){var M=0;switch(E){case "left":M=30;break;case "right":M=-30;break;default:M=E}Q.setPanButton(p,M)},destroy:function(){n.Widget.prototype.destroy.apply(this,arguments);n(this.element).html("")}})})(jQuery);
